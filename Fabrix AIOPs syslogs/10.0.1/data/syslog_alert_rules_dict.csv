action,alarm_class,reason,rule,rule_id,severity,state,raise_code,grok,key_eval
DROP,Interface,LINK UP Alert,syslog_code = "LINEPROTO-5-UPDOWN" and raw contains "changed state to up" and raw contains "Serial",A098,Info,Clear,,"^(?:<\d+>\s+%{SYSLOGTIMESTAMP}\s+)?%%{DATA:syslog_code}: .*Interface\s+(?<interface_name>[A-Za-z]+[A-Za-z0-9/._-]*),?.*$",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
DROP,Interface,LINK DOWN Alert,syslog_code = "LINEPROTO-5-UPDOWN" and raw contains "changed state to down" and raw contains "Serial",A099,Info,Open,,"^(?:<\d+>\s+%{SYSLOGTIMESTAMP}\s+)?%%{DATA:syslog_code}: .*Interface\s+(?<interface_name>[A-Za-z]+[A-Za-z0-9/._-]*),?.*$",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
KEEP,Interface,LINK UP Alert,syslog_code = "LINEPROTO-5-UPDOWN" and raw contains "changed state to up",A100,Info,Clear,,"^(?:<\d+>\s+%{SYSLOGTIMESTAMP}\s+)?%%{DATA:syslog_code}: .*Interface\s+(?<interface_name>[A-Za-z]+[A-Za-z0-9/._-]*),?.*$",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
KEEP,Interface,LINK DOWN Alert,syslog_code = "LINEPROTO-5-UPDOWN" and raw contains "changed state to down",A101,Info,Open,,"^(?:<\d+>\s+%{SYSLOGTIMESTAMP}\s+)?%%{DATA:syslog_code}: .*Interface\s+(?<interface_name>[A-Za-z]+[A-Za-z0-9/._-]*),?.*$",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
KEEP,Interface,ADMIN UP Alert,raw contains "ADMIN UP",A102,Info,Clear,,"%{GREEDYDATA}: (Line protocol on )?Interface %{DATA:interface_name}(,)? (changed state|has changed state) to (?<syslog_code>ADMIN UP)",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
KEEP,MemoryAllocationFailure,Memory Allocation Failure,syslog_code = "MEM_ECC-2-MALLOC",A103,Info,Open,,(?:<%{INT}> )?(?:%{MONTH} +%{MONTHDAY} +%{TIME} )?%?%{NOTSPACE:syslog_code}:,f'{rda_gw_client_ip}_{syslog_code}'
KEEP,PowerSupply,Power Supply Failure,syslog_code = "CI-3-PSFAIL",A104,Notice,Open,,<%{INT}> %{MONTH} +%{MONTHDAY} +%{TIME} %%{NOTSPACE:syslog_code}\s*:,f'{rda_gw_client_ip}_{syslog_code}'
DROP,Interface,Interface up,syslog_code = "LINK-3-UPDOWN" and raw contains "changed state to up" and raw contains "Serial",A10401,Info,Clear,,"%{GREEDYDATA}:\s%%{NOTSPACE:syslog_code}: Interface %{DATA:interface},",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
DROP,Interface,Interface down,syslog_code = "LINK-3-UPDOWN" and raw does not contains "changed state to up" and raw contains "Serial",A10402,Info,Open,,"%{GREEDYDATA}:\s%%{NOTSPACE:syslog_code}: Interface %{DATA:interface},",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
KEEP,Interface,Interface up,syslog_code = "LINK-3-UPDOWN" and raw contains "changed state to up",A105,Info,Clear,,"%{GREEDYDATA}:\s%%{NOTSPACE:syslog_code}: Interface %{DATA:interface},",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
KEEP,Interface,Interface down,syslog_code = "LINK-3-UPDOWN" and raw does not contains "changed state to up",A106,Info,Open,,"%{GREEDYDATA}:\s%%{NOTSPACE:syslog_code}: Interface %{DATA:interface},",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
KEEP,FanFailure,Fan Failure,syslog_code = "CI-3-BLOWER",A107,Notice,Open,,<%{INT}> %{MONTH} +%{MONTHDAY} +%{TIME} %%{NOTSPACE:syslog_code}:,f'{rda_gw_client_ip}_{syslog_code}'
KEEP,Environment,Temperature Threshold Crossed,syslog_code = "ENVIRONMENTAL-1-ALERT",A108,Notice,Open,,(?:<%{INT:pri}>\s*)?(?:%{SYSLOGTIMESTAMP:timestamp}\s+)?(?:%{HOSTNAME:host}\s+)?%%{DATA:syslog_code}: %{GREEDYDATA:message},f'{rda_gw_client_ip}_{syslog_code}'
KEEP,Module,Card Issue / Forced Reload of Linecard,syslog_code = "CARD_STATE-4-FORCE_RESET",A109,Info,Open,,(?:<%{INT:pri}>\s*)?(?:%{SYSLOGTIMESTAMP:timestamp}\s+)?(?:%{HOSTNAME:host}\s+)?%%{DATA:syslog_code}: %{GREEDYDATA:message},f'{rda_gw_client_ip}_{syslog_code}'
DROP,Interface,Interface Admin DOWN Alert,syslog_code = "ETHPORT-5-IF_DOWN_ADMIN_DOWN" and raw contains "Serial",A1090,Info,Open,ETHPORT-5-IF_DOWN_ADMIN_DOWN,(?<syslog_code>ETHPORT-5-IF_DOWN_ADMIN_DOWN):.*?(?<interface_name>[A-Za-z0-9._\/-]+),f'{rda_gw_client_ip}_{interface_name}_{raise_code}'
DROP,Interface,Interface up,syslog_code = "ETHPORT-5-IF_UP" and raw contains "Serial",A1091,Info,Clear,ETHPORT-5-IF_DOWN_ADMIN_DOWN,(?<syslog_code>ETHPORT-5-IF_UP):.*?(?<interface_name>[A-Za-z0-9\-\_\.\/]+),f'{rda_gw_client_ip}_{interface_name}_{raise_code}'
DROP,Interface,Interface Status Down Alert,syslog_code = "ETHPORT-5-IF_DOWN_LINK_FAILURE" and raw contains "Serial",A1092,Info,Open,ETHPORT-5-IF_DOWN_ADMIN_DOWN,(?<syslog_code>ETHPORT-5-IF_DOWN_LINK_FAILURE):.*?(?<interface_name>[A-Za-z0-9._\/-]+),f'{rda_gw_client_ip}_{interface_name}_{raise_code}'
KEEP,Interface,Interface Admin DOWN Alert,syslog_code = "ETHPORT-5-IF_DOWN_ADMIN_DOWN",A110,Info,Open,ETHPORT-5-IF_DOWN_ADMIN_DOWN,"(?<syslog_code>ETHPORT-5-IF_DOWN_ADMIN_DOWN):.*?(?<interface_name>[A-Za-z0-9._\/-]+)
",f'{rda_gw_client_ip}_{interface_name}_{raise_code}'
KEEP,Interface,Interface up,syslog_code = "ETHPORT-5-IF_UP",A111,Info,Clear,ETHPORT-5-IF_DOWN_ADMIN_DOWN,(?<syslog_code>ETHPORT-5-IF_UP):.*?(?<interface_name>[A-Za-z0-9\-\_\.\/]+),f'{rda_gw_client_ip}_{interface_name}_{raise_code}'
KEEP,Interface,Interface Status Down Alert,syslog_code = "ETHPORT-5-IF_DOWN_LINK_FAILURE",A112,Info,Open,ETHPORT-5-IF_DOWN_ADMIN_DOWN,(?<syslog_code>ETHPORT-5-IF_DOWN_LINK_FAILURE):.*?(?<interface_name>[A-Za-z0-9._\/-]+),f'{rda_gw_client_ip}_{interface_name}_{raise_code}'
KEEP,PowerSupply,Power Supply Failure,syslog_code = "PLATFORM-2-PS_FAIL",A113,Major,Open,,.*(?:%| )?(?<syslog_code>PLATFORM-2-PS_FAIL):?\s*(?:Module\s%{INT:module}:?\s*)?Power\s*Supply\s*%{INT:power_supply_id}\s*(?<log_message>.*),f'{rda_gw_client_ip}_{syslog_code}'
KEEP,FanFailure,Fan Failure,syslog_code = "PLATFORM-1-FAN_FAIL",A114,Major,Open,,.*(?:%| )?(?<syslog_code>PLATFORM-1-FAN_FAIL):?\s*(?:Module\s%{INT:module}:?\s*)?Fan\s*(?:Tray\s*)?(?:\s*%{INT:fan_id})?\s*(?<log_message>.*),f'{rda_gw_client_ip}_{syslog_code}'
KEEP,BGP,BGP Neighbor is up,syslog_code = "BGP-5-ADJCHANGE" and raw matches ".* neighbor [0-9a-zA-Z:.]+ [Uu]p.*",A115,Major,Clear,,.*(?:%| )?(?<syslog_code>BGP-5-ADJCHANGE):\s*neighbor\s+(?<peer_ip>%{IPORHOST})(?:\s+(?<session_role>active|passive))?\s+(?<bgp_state>Up|Down)\s*(?:.*?\bbfd_sess_ld(?:=| )(?<bfd_sess_ld>\S+))?(?:.*?\bbfd_sess_handle(?:=| )(?<bfd_sess_handle>\S+))?\s*(?<reason>.*),f'{device_ip}_{raise_code}_{peer_ip}'
KEEP,BGP,BGP Neighbor is down,syslog_code = "BGP-5-ADJCHANGE" and raw matches ".* neighbor [0-9a-zA-Z:.]+ [dD]own.*",A116,Major,Open,,.*(?:%| )?(?<syslog_code>BGP-5-ADJCHANGE):\s*neighbor\s+(?<peer_ip>%{IPORHOST})(?:\s+(?<session_role>active|passive))?\s+(?<bgp_state>Up|Down)\s*(?:.*?\bbfd_sess_ld(?:=| )(?<bfd_sess_ld>\S+))?(?:.*?\bbfd_sess_handle(?:=| )(?<bfd_sess_handle>\S+))?\s*(?<reason>.*),f'{device_ip}_{raise_code}_{peer_ip}'
KEEP,OSPF,OSPF Neighbor is up,syslog_code = "OSPF-5-ADJCHANGE" and raw contains "FULL",A117,Major,Clear,,.*(?:%| )?(?<syslog_code>OSPF-5-ADJCHANGE):\s*Nbr\s+(?<ospf_nbr_ip>%{IPORHOST})\s+on\s+(?<ospf_interface>[A-Za-z0-9\/\.\-\_:]+),f'{device_ip}_{raise_code}_{ospf_nbr_ip}_{ospf_interface}'
KEEP,OSPF,OSPF Neighbor is down,syslog_code = "OSPF-5-ADJCHANGE" and raw does not contain "FULL",A118,Major,Open,,.*(?:%| )?(?<syslog_code>OSPF-5-ADJCHANGE):\s*Nbr\s+(?<ospf_nbr_ip>%{IPORHOST})\s+on\s+(?<ospf_interface>[A-Za-z0-9\/\.\-\_:]+),f'{device_ip}_{raise_code}_{ospf_nbr_ip}_{ospf_interface}'
KEEP,Module,Module Down,syslog_code = "MODULE-2-MOD_FAILURE",A119,Major,Open,,.*(?:%| )?(?<syslog_code>MODULE-2-MOD_FAILURE):\s*Re-initialization\s+module\s+(?<module>\d+)\s*\(Serial number:\s*(?<serial_number>[A-Za-z0-9]+)\)\s*failed,f'{rda_gw_client_ip}_{syslog_code}'
KEEP,Environment,Temperature Threshold Exceeded,syslog_code = "PLATFORM-0-MOD_TEMPMAJALRM",A120,Major,Open,,".*(?:%| )?(?<syslog_code>PLATFORM-0-MOD_TEMPMAJALRM):\s*Module\s+(?<module>\d+)\s+temperature\s+major\s+alarm(?:,?\s*current\s+temp\s+(?<current_temperature>\d+)[cC])?",f'{rda_gw_client_ip}_{syslog_code}'
KEEP,HighTxSFPPowerLevel,High TX Power Level on SFP Cleared,syslog_code = "ETHPORT-3-IF_SFP_ALARM" and raw contains "Cleared|cleared" and raw contains "High Tx",A121,Major,Clear,HighTxSFPPowerLevel,.*(?:%| )?(?<syslog_code>ETHPORT-3-IF_SFP_ALARM):\s*Interface\s+(?<interface_name>[A-Za-z0-9\/\.\-\_:]+)\s*:\s*(?<alarm_message>.*),f'{rda_gw_client_ip}_{interface_name}_{raise_code}'
KEEP,HighTxSFPPowerLevel,High TX Power Level on SFP,syslog_code = "ETHPORT-3-IF_SFP_ALARM" and raw does not contain "Cleared&cleared" and raw contains "High Tx",A122,Major,Open,HighTxSFPPowerLevel,.*(?:%| )?(?<syslog_code>ETHPORT-3-IF_SFP_ALARM):\s*Interface\s+(?<interface_name>[A-Za-z0-9\/\.\-\_:]+)\s*:\s*(?<alarm_message>.*),f'{rda_gw_client_ip}_{interface_name}_{raise_code}'
KEEP,LowTxSFPPowerLevel,Low TX Power Level on SFP Cleared,syslog_code = "ETHPORT-3-IF_SFP_ALARM" and raw contains "Cleared|cleared" and raw contains "Low Tx",A123,Major,Clear,LowTxSFPPowerLevel,.*(?:%| )?(?<syslog_code>ETHPORT-3-IF_SFP_ALARM):\s*Interface\s+(?<interface_name>[A-Za-z0-9\/\.\-\_:]+)\s*:\s*(?<alarm_message>.*),f'{rda_gw_client_ip}_{interface_name}_{raise_code}'
KEEP,LowTxSFPPowerLevel,Low TX Power Level on SFP,syslog_code = "ETHPORT-3-IF_SFP_ALARM" and raw does not contain "Cleared&cleared" and raw contains "Low Tx",A124,Major,Open,LowTxSFPPowerLevel,.*(?:%| )?(?<syslog_code>ETHPORT-3-IF_SFP_ALARM):\s*Interface\s+(?<interface_name>[A-Za-z0-9\/\.\-\_:]+)\s*:\s*(?<alarm_message>.*),f'{rda_gw_client_ip}_{interface_name}_{raise_code}'
KEEP,HighRxSFPPowerLevel,High RX Power Level on SFP Cleared,syslog_code = "ETHPORT-3-IF_SFP_ALARM" and raw contains "Cleared|cleared" and raw contains "High Rx",A125,Major,Clear,HighRxSFPPowerLevel,.*(?:%| )?(?<syslog_code>ETHPORT-3-IF_SFP_ALARM):\s*Interface\s+(?<interface_name>[A-Za-z0-9\/\.\-\_:]+)\s*:\s*(?<alarm_message>.*),f'{rda_gw_client_ip}_{interface_name}_{raise_code}'
KEEP,HighRxSFPPowerLevel,High RX Power Level on SFP,syslog_code = "ETHPORT-3-IF_SFP_ALARM" and raw does not contain "Cleared&cleared" and raw contains "High Rx",A126,Major,Open,HighRxSFPPowerLevel,.*(?:%| )?(?<syslog_code>ETHPORT-3-IF_SFP_ALARM):\s*Interface\s+(?<interface_name>[A-Za-z0-9\/\.\-\_:]+)\s*:\s*(?<alarm_message>.*),f'{rda_gw_client_ip}_{interface_name}_{raise_code}'
KEEP,LowRxSFPPowerLevel,Low RX Power Level on SFP Cleared,syslog_code = "ETHPORT-3-IF_SFP_ALARM" and raw contains "Cleared|cleared" and raw contains "Low Rx",A127,Major,Clear,LowRxSFPPowerLevel,.*(?:%| )?(?<syslog_code>ETHPORT-3-IF_SFP_ALARM):\s*Interface\s+(?<interface_name>[A-Za-z0-9\/\.\-\_:]+)\s*:\s*(?<alarm_message>.*),f'{rda_gw_client_ip}_{interface_name}_{raise_code}'
KEEP,LowRxSFPPowerLevel,Low RX Power Level on SFP,syslog_code = "ETHPORT-3-IF_SFP_ALARM" and raw does not contain "Cleared&cleared" and raw contains "Low Rx",A128,Major,Open,LowRxSFPPowerLevel,.*(?:%| )?(?<syslog_code>ETHPORT-3-IF_SFP_ALARM):\s*Interface\s+(?<interface_name>[A-Za-z0-9\/\.\-\_:]+)\s*:\s*(?<alarm_message>.*),f'{rda_gw_client_ip}_{interface_name}_{raise_code}'
KEEP,PowerSupply,Power Supply Failure ,syslog_code = "NOHMS-2-NOHMS_DIAG_ERR_PS_FAIL",A129,Major,Open,,.*(?:%| )?(?<syslog_code>NOHMS-2-NOHMS_DIAG_ERR_PS_FAIL):\s*System\s+minor\s+alarm\s+on\s+power\s+supply\s+(?<power_supply_id>\d+):\s*(?<alarm_message>.*),f'{rda_gw_client_ip}_{syslog_code}'
KEEP,IP,Duplicate IP address,syslog_code = "IP-4-DAD_FAILED_EVENT",A130,Major,Open,,.*(?:%| )?(?<syslog_code>IP-4-DAD_FAILED_EVENT):\s*Duplicate\s+address\s+detected\s+for\s+(?<dad_ip>[A-Fa-f0-9:\.]+)\s+on\s+(?<interface_name>[A-Za-z0-9\/\.\-\_:]+),f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
KEEP,CoreDump,Process Crash. Core Dump Created,syslog_code = "OS-DUMPER-5-DUMP_SUCCESS",A131,Info,Open,,^<%{INT:priority}>%{INT:number}: %{IP:host} %{DATA:location}:%{MONTH:month} %{INT:day} %{TIME:time} UTC: process\[%{INT:process_id}\]: %%{DATA:syslog_code} : %{GREEDYDATA:message}$,f'{rda_gw_client_ip}_{location}_{syslog_code}'
KEEP,BGP,BGP Neighbor is up,syslog_code = "ROUTING-BGP-5-ADJCHANGE_DETAIL" and raw matches ".* neighbor [0-9a-zA-Z:.]+ [Uu]p.*",A132,Major,Clear,,ROUTING-BGP-%{INT:severity}-ADJCHANGE_DETAIL: neighbor %{IPORHOST:peer_ip} %{WORD:state}( %{GREEDYDATA:reason})?,f'{rda_gw_client_ip}_{peer_ip}_{syslog_code}'
KEEP,BGP,BGP Neighbor is down,syslog_code = "ROUTING-BGP-5-ADJCHANGE_DETAIL" and raw matches ".* neighbor [0-9a-zA-Z:.]+ [dD]own.*",A133,Major,Open,,ROUTING-BGP-%{INT:severity}-ADJCHANGE_DETAIL: neighbor %{IPORHOST:peer_ip} %{WORD:state}( %{GREEDYDATA:reason})?,f'{rda_gw_client_ip}_{peer_ip}_{syslog_code}'
KEEP,FanFailure,Fan RPM is normal,syslog_code = "PLATFORM-ENVMON-2-FAN_CLEAR",A134,Info,Clear,PLATFORM-ENVMON-2-FAN,^(?:<%{INT:pri}>)?(?:%{SYSLOGTIMESTAMP:timestamp}\s+)?(?:%{HOSTNAME:host}\s+)?(?:%{INT:seq}:?\s+)?\s*[: ]*%{DATA:facility}-%{INT:severity}-%{DATA:event}[: ]+Fan\s+%{INT:fan_id}\s+%{GREEDYDATA:status}$,f'{rda_gw_client_ip}_{fan_id}_{raise_code}'
KEEP,FanFailure,Fan RPM is below operating level,syslog_code = "PLATFORM-ENVMON-2-FAN_FAIL",A135,Info,Open,PLATFORM-ENVMON-2-FAN,^(?:<%{INT:pri}>)?(?:%{SYSLOGTIMESTAMP:timestamp}\s+)?(?:%{HOSTNAME:host}\s+)?(?:%{INT:seq}:?\s+)?\s*[: ]*%{DATA:facility}-%{INT:severity}-%{DATA:event}[: ]+Fan\s+%{INT:fan_id}\s+%{GREEDYDATA:status}$,f'{rda_gw_client_ip}_{fan_id}_{raise_code}'
KEEP,FanFailure,Fan RPM is normal for all fans on indicated fan tray,syslog_code = "PLATFORM-ENVMON-2-FANTRAY_CLEAR",A136,Info,Clear,PLATFORM-ENVMON-2-FANTRAY,^(?:<%{INT:pri}>)?(?:%{SYSLOGTIMESTAMP:timestamp}\s+)?(?:%{HOSTNAME:host}\s+)?(?:%{INT:seq}:?\s+)?\s*[: ]*%{DATA:facility}-%{INT:severity}-%{DATA:event}[: ]+Fan[Tt]ray\s+%{INT:fantray_id}\s+%{GREEDYDATA:status}$,f'{rda_gw_client_ip}_{tray_id}_{raise_code}'
KEEP,FanFailure,Fan Tray Failure,syslog_code = "PLATFORM-ENVMON-2-FANTRAY_FAIL",A137,Info,Open,PLATFORM-ENVMON-2-FANTRAY,<%{INT:pri}>%{INT:seq}: %{IP:device} %{DATA:location}:%{MONTH} %{MONTHDAY} %{TIME} %{WORD:tz}: process\[%{INT:pid}\]: %%{DATA:syslog_code} : Fan tray failure on slot %{INT:slot}/%{DATA:tray}/%{DATA:subslot},f"{rda_gw_client_ip}_{slot}_{tray}_{subslot}_{raise_code}"
KEEP,Module,Power module failure,syslog_code = "PLATFORM-PWRMON-2-MODULE_FAIL_REASON",A138,Info,Open,,^(?:<%{INT:pri}>)?(?:%{IP:device_ip}\s+)?(?:%{DATA:device_path}):%{SYSLOGTIMESTAMP:timestamp}\s+UTC:\s*(?:%{DATA:process}\[%{INT:pid}\]:\s+)?%{DATA:facility}-%{INT:severity}-%{DATA:event}\s*[: ]+\s*Power-module\s+%{DATA:module_id}\s+fail reason:\s+%{GREEDYDATA:reason}$,f'{rda_gw_client_ip}_{syslog_code}'
KEEP,Interface,Interface up,syslog_code = "PKT_INFRA-LINK-3-UPDOWN" and raw contains "changed state to Up",A139,Major,Clear,,"Interface\s*%{DATA:interface_name},",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
KEEP,Interface,Interface down,syslog_code = "PKT_INFRA-LINK-3-UPDOWN" and raw does not contains "changed state to Up",A140,Major,Open,,"Interface\s*%{DATA:interface_name},",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
KEEP,Interface,Interface up,syslog_code = "PKT_INFRA-LINEPROTO-5-UPDOWN" and raw contains "changed state to Up",A141,Major,Clear,,"Line protocol on Interface\s*%{DATA:interface_name},",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
KEEP,Interface,Interface down,syslog_code = "PKT_INFRA-LINEPROTO-5-UPDOWN" and raw does not contains "changed state to Up",A142,Major,Open,,"Line protocol on Interface\s*%{DATA:interface_name},",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
KEEP,T1E1,T1E1 is operationally down due to alarm,syslog_code = "L2-T1E1-4-UPDOWN" and raw ends with "DOWN",A143,Major,Open,,^(?:<%{INT:pri}>%{INT:seq}: )?(?:%{IP:host} )?(?:%{DATA:device_path}: )?(?:process\[%{INT:pid}\]: )?%{DATA:syslog_code} : at %{DATA:t1e1_slot}: ALARM : LINESTATE STATE : %{WORD}$,f'{rda_gw_client_ip}_{t1e1_slot}_{syslog_code}'
KEEP,T1E1,T1E1 is operationally up,syslog_code = "L2-T1E1-4-UPDOWN" and raw ends with "UP",A174,Major,Clear,,(?<t1e1_interface>(T\d+(?:\/\d+)+)|(?:\d+\/\d+\/\d+)),f'{rda_gw_client_ip}_{syslog_code}_{t1e1_interface}'
KEEP,SONET,SONET Alarm has been declared or released,syslog_code = "L2-SONET_LOCAL-4-ALARM",A144,Major,Open,,^(?:<%{INT:pri}>%{INT:seq}: )?(?:%{IP:device_ip} )?(?:%{DATA:node}: )?(?:%{SYSLOGTIMESTAMP:timestamp}: )?(?:process\[%{INT:pid}\]: )?%{DATA:syslog_code} : Location %{DATA:sonet_loc}: Type %{WORD:alarm_type} Status$,f'{rda_gw_client_ip}_{sonet_loc}_{alarm_type}_{syslog_code}'
KEEP,MemoryAllocationFailure,Memory Allocation Failure,syslog_code = "HA-LRD-3-MEM_ALLOC_FAIL",A145,Major,Open,,^(?:<%{INT:pri}>%{INT:seq}: )?(?:%{IP:device_ip} )?(?:%{DATA:node}:)?(?:%{SYSLOGTIMESTAMP:timestamp}: )?(?:process\[%{INT:pid}\]: )?%{SYSLOGFACILITY}?:? %{GREEDYDATA:message}$,f'{rda_gw_client_ip}_{syslog_code}'
KEEP,MemoryAllocationFailure,FIB Memory Allocation Failure,syslog_code = "ROUTING-FIB-3-MALLOC_FAILED",A146,Major,Open,,,f'{rda_gw_client_ip}_{syslog_code}'
KEEP,MemoryAllocationFailure,L2RIB Memory Allocation Failure,syslog_code = "L2-L2RIB-3-MALLOC_FAILED",A147,Major,Open,,,f'{rda_gw_client_ip}_{syslog_code}'
KEEP,ISIS,ISIS ADJ UP,syslog_code = "ROUTING-ISIS-5-ADJCHANGE" and raw contains "Up",A148,Major,Clear,,Adjacency to %{HOSTNAME:neighbor} \(%{DATA:interface}\),f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
KEEP,ISIS,ISIS ADJ DOWN,syslog_code = "ROUTING-ISIS-5-ADJCHANGE" and raw does not contains "Up",A149,Major,Open,,Adjacency to %{HOSTNAME:neighbor} \(%{DATA:interface}\),f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
KEEP,SHELFMGR,Card state transition occurred,syslog_code = "PLATFORM-SHELFMGR-6-NODE_STATE_CHANGE",A150,Major,Open,,%{DATA:syslog_code}\s*:\s*(?:Node|node|Slot|slot|Chassis node)\s*%{DATA:node_id}\s*(?:State\s+Changed\s+To|state\s+changed\s+to|is\s+now|transitioned\s+to)\s*%{WORD:node_state},f'{rda_gw_client_ip}_{node_id}_{syslog_code}'
KEEP,OSPF,OSPF Neighbor is up,syslog_code = "ROUTING-OSPF-5-ADJCHG" and raw contains "to FULL",A151,Major,Clear,,.*Nbr\s%{IPV4:peer_ip}\son\s%{DATA:interface_name}\s.*,f'{rda_gw_client_ip}_{peer_ip}_{interface_name}_{syslog_code}'
KEEP,OSPF,OSPF Neighbor is down,syslog_code = "ROUTING-OSPF-5-ADJCHG" and raw does not contain "to FULL",A152,Major,Open,,.*Nbr\s%{IPV4:peer_ip}\son\s%{DATA:interface_name}\s.*,f'{rda_gw_client_ip}_{peer_ip}_{interface_name}_{syslog_code}'
KEEP,IP,Duplicate IP address,syslog_code = "IPE-4-DUPLICATE_LOCAL_HOST",A153,Info,Open,,Host %{IP:host_ip} on interface %{DATA:interface_name} has duplicate ip address,f'{rda_gw_client_ip}_{host_ip}_{interface_name}_{syslog_code}'
KEEP,DuplexMismatch,Mismatch of Duplex Config Discovered,syslog_code = "CDP-4-DUPLEX_MISMATCH",A155,Info,Open,,(?:<%{NUMBER:syslog_pri}>%{NUMBER:syslog_seq}: )?(?:%{MONTH:month} %{NUMBER:day} %{TIME:time}(?: %{WORD:tz})?: )?%CDP-4-DUPLEX_MISMATCH: Duplex mismatch (?:discovered|detected) on %{DATA:interface_name} \(%{DATA:local_duplex}\) from %{DATA:neighbor_name} \(%{DATA:neighbor_interface}\),f'{interface_name}_{neighbor_name}_{neighbor_interface}'
KEEP,Module,FRULink module has been removed,syslog_code = "PLATFORM_PM-6-FRULINK_REMOVED",A156,Major,Open,,(?:<%{NUMBER:pri}>%{NUMBER:seq}: )?(?:\*?%{MONTH:month} %{MONTHDAY:day} %{TIME:time} %{WORD:tz}: )?%{DATA:syslog_code}: (?:Node %{DATA:node}: )?FRU %{DATA:fru_type}(?: %{DATA:fru_id}(?:/%{DATA:fru_sub_id})?)?(?: Link)? Removed,f'{rda_gw_client_ip}_{syslog_code}_{fru_type}_{fru_id}'
DROP,,BGP neighbor topology was removed from a session,syslog_code = "BGP_SESSION-5-ADJCHANGE",A157,Info,,,(?:<%{NUMBER:pri}>1 )?(?:%{TIMESTAMP_ISO8601:timestamp} %{HOSTNAME:host} - - - - )?%{DATA:syslog_prefix}%{DATA:syslog_code}: neighbor %{IP:neighbor_ip}(?:::%{IPV6:neighbor_ip6})? %{WORD:afi} Unicast topology base removed from session\s*(?:%{GREEDYDATA:description})?,f'{rda_gw_client_ip}_{syslog_code}_{neighbor}'
KEEP,MemoryAllocationFailure,Memory Allocation Failure,syslog_code = "MEM_MGR-3-MALLOC_NO_MEM",A158,Info,Open,,,f'{rda_gw_client_ip}_{syslog_code}'
KEEP,Environment,The chassis inside temperature exceeds the max temperature threshold,syslog_code = "ENVIRONMENT-3-OVERTEMP",A159,Notice,Open,,,f'{rda_gw_client_ip}_{syslog_code}'
KEEP,IPSecFailure,IPSEC Negotiation has failed,syslog_code = "CRYPTO-5-IPSEC_FAILURE",A160,Info,Open,,,f'{rda_gw_client_ip}_{syslog_code}'
KEEP,IPSecDown,IPSec Crypto Security Association Down,syslog_code = "IKEV2-5-SA_DOWN",A161,Info,Open,IKEV2-5-SA,,f'{rda_gw_client_ip}_{raise_code}'
KEEP,IPSecDown,IPSec Crypto Security Association Up,syslog_code = "IKEV2-5-SA_UP",A162,Info,Clear,IKEV2-5-SA,,f'{rda_gw_client_ip}_{raise_code}'
DROP,BFDDown,bfd session down,syslog_code = "BFDFSM-6-BFD_SESS_DOWN",A163,Info,Open,BFDFSM-6-BFD_SESS,,f'{rda_gw_client_ip}_{raise_code}'
DROP,BFDDown,bfd session up,syslog_code = "BFDFSM-6-BFD_SESS_UP",A164,Info,Clear,BFDFSM-6-BFD_SESS,,f'{rda_gw_client_ip}_{raise_code}'
KEEP,FanFailure,Faulty Fan Detected,syslog_code = "PLATFORM_ENV-1-FAN",A165,Notice,Open,PLATFORM_ENV-1-FAN,Fan %{DATA:fan_slot} %{GREEDYDATA:fan_state},f'{rda_gw_client_ip}_{raise_code}_{fan_slot}'
KEEP,FanFailure,FRU Fan is OK,syslog_code = "PLATFORM_ENV-1-FRU_FAN_OK",A166,Notice,Clear,PLATFORM_ENV-1-FAN,Fan\s+%{NOTSPACE:fan_slot},f'{rda_gw_client_ip}_{raise_code}_{fan_slot}'
KEEP,FanFailure,Power Supply Fan Failed,syslog_code = "PLATFORM_ENV-1-FRU_PS_FAN_FAILED",A167,Notice,Open,PLATFORM_ENV-1-FRU_PS_FAN_FAILED,%{GREEDYDATA}(?:Power Supply|PSU)\s+%{NOTSPACE:ps_slot}\s+%{GREEDYDATA},f'{rda_gw_client_ip}_{raise_code}_{ps_slot}'
KEEP,FanFailure,Power Supply Fan is OK,syslog_code = "PLATFORM_ENV-1-FRU_PS_FAN_OK",A168,Notice,Clear,PLATFORM_ENV-1-FRU_PS_FAN_FAILED,%{GREEDYDATA}(?:Power Supply|PSU)\s+%{NOTSPACE:ps_slot}\s+%{GREEDYDATA},f'{rda_gw_client_ip}_{raise_code}_{ps_slot}'
KEEP,PowerSupply,Power Supply Failure,syslog_code = "PLATFORM_ENV-1-PWR",A169,Notice,Open,PLATFORM_ENV-1-PWR,(?:%{SYSLOGBASE}:\s*)?%{GREEDYDATA}(?:Power Supply|PSU|Internal power supply)(?:\s+(?<ps_slot>[A-Za-z0-9\/]+))?\s+%{GREEDYDATA},f'{rda_gw_client_ip}_{raise_code}_{ps_slot}'
KEEP,PowerSupply,Power Supply is OK,syslog_code = "PLATFORM_ENV-1-FRU_PS_OK",A170,Notice,Clear,PLATFORM_ENV-1-PWR,(?:%{SYSLOGBASE}:\s*)?(?:FRU\s+)?(?:Power\s+Supply|PSU)\s+(?<ps_slot>[A-Za-z0-9\/]+)?\s*(OK|ok|Operational|operational|Inserted|inserted|Restored|restored|power good|Power Good)?,f'{rda_gw_client_ip}_{raise_code}_{ps_slot}'
KEEP,FanFailure,Fan Failure,syslog_code = "PLATFORM-1-PFM_ALERT",A171,Major,Open,,%{GREEDYDATA}?:\s*%PLATFORM-1-PFM_ALERT:\s*%{WORD:pfm_type}:\s*%{WORD:pfm_target},f'{rda_gw_client_ip}_{syslog_code}_{pfm_type}_{pfm_target}'
KEEP,BGP_MAXPFXEXCEED,theshold set for BGP maximum-prefixes has been exceeded,syslog_code = "BGP-3-MAXPFXEXCEED",A172,Major,Open,,%BGP-3-MAXPFXEXCEED: Number of prefixes received from %{IP:bgp_neighbor_ip}(?: \(afi %{NUMBER}\))?: %{NUMBER} exceeds limit %{NUMBER},f'{rda_gw_client_ip}_{syslog_code}_{bgp_neighbor_ip}'
KEEP,BGP_MAXPFX,theshold set for BGP maximum-prefixes is nearing the maximum,syslog_code = "BGP-4-MAXPFX",A173,Major,Open,,%{GREEDYDATA}BGP-4-MAXPFX:?%{GREEDYDATA}(from|Neighbor|neighbor)\s+%{IP:bgp_neighbor_ip},f'{rda_gw_client_ip}_{syslog_code}_{bgp_neighbor_ip}'
KEEP,Module,Module Failure,syslog_code = "SPA_OIR-6-OFFLINECARD",A175,Info,Open,SPA_OIR-6-LINECARD,subslot\s+(?<spa_subslot>\d+\/\d+),f'{rda_gw_client_ip}_{raise_code}_{spa_subslot}'
KEEP,Module,Module Failure,syslog_code = "SPA_OIR-6-ONLINECARD",A176,Info,Clear,SPA_OIR-6-LINECARD,subslot\s+(?<spa_subslot>\d+\/\d+),f'{rda_gw_client_ip}_{raise_code}_{spa_subslot}'
DROP,,,*,Z999,,,,,
