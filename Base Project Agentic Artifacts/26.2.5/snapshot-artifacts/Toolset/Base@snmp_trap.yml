enabled: true
domain: snmp_trap
description: SNMP Trap based related tools.
tools:
    -   name: get_snmp_trap_meta_data
        type: streamMetadata
        stream: snmp_trap_event_stream
        description: 'Retrieves the complete schema of snmp trap fields available
            in the system.

            '
    -   name: get_snmp_traps
        type: streamQuery
        stream: snmp_trap_event_stream
        description: 'Get snmp traps.it retrieves the snmp traps from the snmp_trap_event_stream
            stream. which includes the following fields: RDA Gateway Timestamp, Source
            IP Address, RDA Gateway Client IP, RDA Gateway Endpoint Name, SNMP Trap
            OID, Command Source, SNMP Trap MIB, Message.

            '
        data_format: csv
        response_prefix: Here are snmp traps in CSV format
        no_data_message: No snmp traps found for the specified parameters
        result_columns:
            rda_gw_timestamp: RDA Gateway Timestamp
            ipAddress: Source IP Address
            rda_gw_client_ip: RDA Gateway Client IP
            rda_gw_ep_name: RDA Gateway Endpoint Name
            snmpTrapOID: SNMP Trap OID
            ccmHistoryEventCommandSource: Command Source
            snmpTrapMIB: SNMP Trap MIB
            message: Message
        parameters:
            -   name: IP
                description: IP Address of the device (e.g. 10.95.140.21 or 10.95.140.23)
                operator: '='
                queryMapping: ipAddress = '{{IP}}'
            -   name: keyword
                description: Keyword to be searched in snmp traps (e.g authenticationFailure,ciscoConfigManEvent)
                operator: contains
                queryMapping: message contains '{{keyword}}'
            -   name: commandSource
                type: string
                operator: contains
                description: Command Source (e.g. SNMP Trap, CommandLine)
                default: null
                queryMapping: ccmHistoryEventCommandSource contains '{{commandSource}}'
            -   name: configurationManagementEvent
                type: string
                operator: contains
                description: Management Information Base (e.g. CISCO-CONFIG-MAN-MIB,
                    SNMPv2-MIB)
                default: null
                queryMapping: snmpTrapMIB contains '{{configurationManagementEvent}}'
            -   name: from_time
                type: string
                description: Query data using a From time, Date and time in ISO format
                default: null
                queryMapping: rda_gw_timestamp after '{{from_time}}'
            -   name: to_time
                type: string
                description: Query data using a To time, Date and time in ISO format
                default: null
                queryMapping: rda_gw_timestamp before '{{to_time}}'
