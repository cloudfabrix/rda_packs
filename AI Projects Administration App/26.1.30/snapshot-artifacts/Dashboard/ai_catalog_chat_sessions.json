{
    "name": "ai_catalog_chat_sessions",
    "label": "AI Catalog Monitor Conversations",
    "description": "rda_chat_sessions: AI Catalog Insights",
    "dashboard_folder": "AI",
    "version": "1.0.2",
    "enabled": true,
    "stream": "rda_chat_sessions",
    "dashboard_type": "template",
    "template_variables": {
        "PERSONA": {
            "default": null,
            "contextId": "persona"
        },
        "AI_PROJECT_NAME": {
            "contextId": "ai_project_name"
        }
    },
    "live_edit": true,
    "dashboard_filters": {
        "time_filter": true,
        "extra_filter": "persona is '{{PERSONA}}'",
        "default_time_filter_labels": [
            "All Time"
        ],
        "columns_filter": [
            {
                "id": "timestamp",
                "label": "Timestamp",
                "type": "DATETIME"
            },
            {
                "id": "USER_ID",
                "label": "User Id",
                "type": "TEXT"
            },
            {
                "id": "context_USER_ID",
                "label": "Context User Id",
                "type": "TEXT"
            },
            {
                "id": "context_USER_ROLE",
                "label": "Context User Role",
                "type": "TEXT"
            },
            {
                "id": "context_approver_userid",
                "label": "Context Approver Userid",
                "type": "TEXT"
            },
            {
                "id": "context_incidentid",
                "label": "Context Incidentid",
                "type": "TEXT"
            },
            {
                "id": "conversationId",
                "label": "Conversationid",
                "type": "TEXT"
            },
            {
                "id": "conversationLabel",
                "label": "Conversationlabel",
                "type": "TEXT"
            },
            {
                "id": "isToolCall",
                "label": "Istoolcall",
                "type": "TEXT"
            },
            {
                "id": "llm",
                "label": "Llm",
                "type": "TEXT"
            },
            {
                "id": "llm_name",
                "label": "Llm Name",
                "type": "TEXT"
            },
            {
                "id": "message",
                "label": "Message",
                "type": "TEXT"
            },
            {
                "id": "persona",
                "label": "Persona",
                "type": "TEXT"
            },
            {
                "id": "prompt_id",
                "label": "Prompt Id",
                "type": "TEXT"
            },
            {
                "id": "request_status",
                "label": "Request Status",
                "type": "TEXT"
            },
            {
                "id": "request_subtype",
                "label": "Request Subtype",
                "type": "TEXT"
            },
            {
                "id": "request_type",
                "label": "Request Type",
                "type": "TEXT"
            },
            {
                "id": "severity",
                "label": "Severity",
                "type": "TEXT"
            },
            {
                "id": "tool_content",
                "label": "Tool Content",
                "type": "TEXT"
            },
            {
                "id": "tool_domain",
                "label": "Tool Domain",
                "type": "TEXT"
            },
            {
                "id": "tool_name",
                "label": "Tool Name",
                "type": "TEXT"
            },
            {
                "id": "tool_status",
                "label": "Tool Status",
                "type": "TEXT"
            },
            {
                "id": "type",
                "label": "Type",
                "type": "TEXT"
            },
            {
                "id": "token_usage_cache_tokens",
                "label": "Token Usage Cache Tokens",
                "type": "DOUBLE"
            },
            {
                "id": "token_usage_input_tokens",
                "label": "Token Usage Input Tokens",
                "type": "DOUBLE"
            },
            {
                "id": "token_usage_output_tokens",
                "label": "Token Usage Output Tokens",
                "type": "DOUBLE"
            },
            {
                "id": "token_usage_reasoning_tokens",
                "label": "Token Usage Reasoning Tokens",
                "type": "DOUBLE"
            },
            {
                "id": "token_usage_total_tokens",
                "label": "Token Usage Total Tokens",
                "type": "DOUBLE"
            }
        ],
        "group_filters": [
            {
                "stream": "rda_chat_sessions",
                "title": "LLM",
                "duration_hours": 1080,
                "limit": 200,
                "extra_filter": "type == 'client'",
                "group_by": [
                    "llm"
                ],
                "ts_column": "timestamp",
                "agg": "sum",
                "column": "count_",
                "type": "int"
            },
            {
                "stream": "rda_chat_sessions",
                "title": "Request Type",
                "duration_hours": 1080,
                "limit": 200,
                "extra_filter": "type == 'client'",
                "group_by": [
                    "request_type"
                ],
                "ts_column": "timestamp",
                "agg": "sum",
                "column": "count_",
                "type": "int"
            },
            {
                "stream": "rda_chat_sessions",
                "title": "User",
                "duration_hours": 1080,
                "limit": 200,
                "extra_filter": "type == 'client'",
                "group_by": [
                    "USER_ID"
                ],
                "ts_column": "timestamp",
                "agg": "sum",
                "column": "count_",
                "type": "int"
            }
        ]
    },
    "dashboard_sections": [
        {
            "title": "Monitor Conversations",
            "show_filter": true,
            "widgets": [
                {
                    "title": "Conversations",
                    "widget_type": "tabular",
                    "duration_hours": 1080,
                    "widget_group": "G0",
                    "max_width": 12,
                    "height": 8,
                    "min_width": 12,
                    "preview_dashboard": "ai_conversation_details",
                    "preview_width": 900,
                    "preview_height": 700,
                    "stream": "rda_chat_sessions",
                    "ts_column": "timestamp",
                    "extra_filter": "type == 'client' and ai_project_name is '{{AI_PROJECT_NAME}}'",
                    "virtual_scrolling": false,
                    "showRowSummary": false,
                    "columns": {
                        "timestamp": {
                            "title": "Timestamp",
                            "type": "DATETIME",
                            "hidden": false
                        },
                        "USER_ID": {
                            "title": "User Id",
                            "type": "TEXT",
                            "hidden": false
                        },
                        "conversationLabel": {
                            "title": "Conversation Label",
                            "type": "TEXT",
                            "hidden": false,
                            "key": true
                        },
                        "request_type": {
                            "title": "Request Type",
                            "type": "TEXT",
                            "hidden": false,
                            "key": true
                        },
                        "persona": {
                            "title": "Persona",
                            "type": "TEXT",
                            "hidden": false
                        },
                        "llm": {
                            "title": "LLM",
                            "type": "TEXT",
                            "hidden": false
                        },
                        "message": {
                            "title": "Message",
                            "type": "TEXT",
                            "hidden": false,
                            "formatter": "truncate"
                        },
                        "conversationId": {
                            "title": "Conversationid",
                            "type": "TEXT",
                            "hidden": true,
                            "key": true
                        },
                        "conversation_id": {
                            "title": "Conversationid",
                            "type": "COMPUTED",
                            "expr": "conversationId",
                            "hidden": true,
                            "key": true
                        }
                    },
                    "actions": [
                        {
                            "appName": "user-dashboard/ai_conversation_details_app",
                            "permission": "agenticai:conversation:view",
                            "drillDownLinkField": "conversationLabel",
                            "identifier": "conversationLabel",
                            "selectionType": "SINGLE",
                            "stateName": "app.featureapp",
                            "title": "View Details",
                            "type": "GO_TO_APP_STATE"
                        }
                    ],
                    "widget_id": "1df1b6dc"
                },
                {
                    "title": "Token Counts",
                    "widget_type": "tabular",
                    "duration_hours": 1080,
                    "widget_group": "G0",
                    "max_width": 12,
                    "height": 8,
                    "min_width": 12,
                    "stream": "rda_chat_sessions",
                    "ts_column": "timestamp",
                    "extra_filter": "ai_project_name is '{{AI_PROJECT_NAME}}'",
                    "columns": {
                        "USER_ID": {
                            "title": "User Id",
                            "type": "TEXT",
                            "hidden": false
                        },
                        "conversationId": {
                            "title": "Conversation ID",
                            "type": "TEXT",
                            "hidden": true,
                            "key": true
                        },
                        "conversationLabel": {
                            "title": "Conversation Label",
                            "type": "TEXT",
                            "hidden": false,
                            "key": true
                        },
                        "llm": {
                            "title": "LLM",
                            "type": "TEXT",
                            "hidden": false
                        },
                        "persona": {
                            "title": "Persona",
                            "type": "TEXT",
                            "hidden": false
                        }
                    },
                    "pivot": {
                        "pivot_type": "advanced",
                        "group_by": [
                            "USER_ID",
                            "conversationId",
                            "conversationLabel",
                            "llm",
                            "persona"
                        ],
                        "series": [
                            {
                                "column": "token_usage_input_tokens",
                                "agg": "sum",
                                "type": "int",
                                "label": "Input Tokens"
                            },
                            {
                                "column": "token_usage_output_tokens",
                                "agg": "sum",
                                "type": "int",
                                "label": "Output Tokens"
                            },
                            {
                                "column": "token_usage_cache_tokens",
                                "agg": "sum",
                                "type": "int",
                                "label": "Cache Tokens"
                            }
                        ]
                    },
                    "actions": [
                        {
                            "appName": "user-dashboard/ai_conversation_details_app",
                            "permission": "agenticai:conversation:view",
                            "drillDownLinkField": "conversationLabel",
                            "identifier": "conversationLabel",
                            "selectionType": "SINGLE",
                            "stateName": "app.featureapp",
                            "title": "View Details",
                            "type": "GO_TO_APP_STATE"
                        }
                    ],
                    "widget_id": "3c025874"
                }
            ]
        }
    ],
    "saved_time": "2025-11-13T08:06:21.806669",
    "attachments": [
        {
            "name": "token_count_bkp",
            "value": "{% raw %}\r\n{# ---- Query Aggregates ---- #}\r\n{% set input_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    aggs=[{\"field\": \"token_usage_input_tokens\", \"func\": \"avg\"}],\r\n    groupby=[\"request_type\"],\r\n    duration_hours=1800000,\r\n    ts_column=\"timestamp\"\r\n) %}\r\n\r\n{% set output_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    aggs=[{\"field\": \"token_usage_output_tokens\", \"func\": \"avg\"}],\r\n    groupby=[\"request_type\"],\r\n    duration_hours=1800000,\r\n    ts_column=\"timestamp\"\r\n) %}\r\n\r\n{% set cache_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    aggs=[{\"field\": \"token_usage_cache_tokens\", \"func\": \"avg\"}],\r\n    groupby=[\"request_type\"],\r\n    duration_hours=1800000,\r\n    ts_column=\"timestamp\"\r\n) %}\r\n\r\n{# ---- Extract only Workflow(Agent) and Copilot ---- #}\r\n{% set workflow_input = (input_data | selectattr(\"request_type\", \"equalto\", \"Agent\") | list) %}\r\n{% set workflow_output = (output_data | selectattr(\"request_type\", \"equalto\", \"Agent\") | list) %}\r\n{% set workflow_cache = (cache_data | selectattr(\"request_type\", \"equalto\", \"Agent\") | list) %}\r\n\r\n{% set copilot_input = (input_data | selectattr(\"request_type\", \"equalto\", \"Copilot\") | list) %}\r\n{% set copilot_output = (output_data | selectattr(\"request_type\", \"equalto\", \"Copilot\") | list) %}\r\n{% set copilot_cache = (cache_data | selectattr(\"request_type\", \"equalto\", \"Copilot\") | list) %}\r\n\r\n{# ---- HTML Display ---- #}\r\n<div style=\"font-family: Arial, sans-serif; font-size: 14px; margin: 10px;\">\r\n\r\n  <div style=\"display: flex; gap: 16px; flex-wrap: wrap; background:#1e293b; padding:16px; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.3); max-height: 240px;\">\r\n    \r\n    <!-- Workflow Card -->\r\n    <div style=\"flex:1; background:#f8fafc; padding:14px; border-radius:10px; box-shadow:0 1px 4px rgba(0,0,0,0.2);\">\r\n      <h3 style=\"margin-top:0; margin-bottom: 5px; color:#0f172a; font-size:16px;\">Average Tokens for Workflow</h3>\r\n      <div style=\"display: flex; gap: 10px;\">\r\n        <div style=\"flex:1; background:#ffffff; padding:10px; border-radius:8px; text-align:center;\">\r\n          <b style=\"color:#334155;\">Input Tokens</b><br>\r\n          <span style=\"color:#2563eb; font-weight:bold;\">\r\n            {{ (workflow_input[0].token_usage_input_tokens_avg|round(2) if workflow_input|length > 0 else 0) }}\r\n          </span>\r\n        </div>\r\n        <div style=\"flex:1; background:#ffffff; padding:10px; border-radius:8px; text-align:center;\">\r\n          <b style=\"color:#334155;\">Output Tokens</b><br>\r\n          <span style=\"color:#16a34a; font-weight:bold;\">\r\n            {{ (workflow_output[0].token_usage_output_tokens_avg|round(2) if workflow_output|length > 0 else 0) }}\r\n          </span>\r\n        </div>\r\n        <div style=\"flex:1; background:#ffffff; padding:10px; border-radius:8px; text-align:center;\">\r\n          <b style=\"color:#334155;\">Cache Tokens</b><br>\r\n          <span style=\"color:#d97706; font-weight:bold;\">\r\n            {{ (workflow_cache[0].token_usage_cache_tokens_avg|round(2) if workflow_cache|length > 0 else 0) }}\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Copilot Card -->\r\n    <div style=\"flex:1; background:#f8fafc; padding:14px; border-radius:10px; box-shadow:0 1px 4px rgba(0,0,0,0.2);\">\r\n      <h3 style=\"margin-top:0; color:#0f172a; font-size:16px;\">Average tokens for Fabaio</h3>\r\n      <div style=\"display: flex; gap: 10px;\">\r\n        <div style=\"flex:1; background:#ffffff; padding:10px; border-radius:8px; text-align:center;\">\r\n          <b style=\"color:#334155;\">Input Tokens</b><br>\r\n          <span style=\"color:#2563eb; font-weight:bold;\">\r\n            {{ (copilot_input[0].token_usage_input_tokens_avg|round(2) if copilot_input|length > 0 else 0) }}\r\n          </span>\r\n        </div>\r\n        <div style=\"flex:1; background:#ffffff; padding:10px; border-radius:8px; text-align:center;\">\r\n          <b style=\"color:#334155;\">Output Tokens</b><br>\r\n          <span style=\"color:#16a34a; font-weight:bold;\">\r\n            {{ (copilot_output[0].token_usage_output_tokens_avg|round(2) if copilot_output|length > 0 else 0) }}\r\n          </span>\r\n        </div>\r\n        <div style=\"flex:1; background:#ffffff; padding:10px; border-radius:8px; text-align:center;\">\r\n          <b style=\"color:#334155;\">Cache Tokens</b><br>\r\n          <span style=\"color:#d97706; font-weight:bold;\">\r\n            {{ (copilot_cache[0].token_usage_cache_tokens_avg|round(2) if copilot_cache|length > 0 else 0) }}\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n</div>\r\n\r\n{% endraw %}\r\n"
        },
        {
            "name": "transparent_token_count",
            "value": "{% raw %}\r\n{# ---- Query Aggregates ---- #}\r\n{% set input_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    aggs=[{\"field\": \"token_usage_input_tokens\", \"func\": \"avg\"}],\r\n    groupby=[\"request_type\"],\r\n    duration_hours=1800000,\r\n    ts_column=\"timestamp\"\r\n) %}\r\n\r\n{% set output_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    aggs=[{\"field\": \"token_usage_output_tokens\", \"func\": \"avg\"}],\r\n    groupby=[\"request_type\"],\r\n    duration_hours=1800000,\r\n    ts_column=\"timestamp\"\r\n) %}\r\n\r\n{% set cache_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    aggs=[{\"field\": \"token_usage_cache_tokens\", \"func\": \"avg\"}],\r\n    groupby=[\"request_type\"],\r\n    duration_hours=1800000,\r\n    ts_column=\"timestamp\"\r\n) %}\r\n\r\n{# ---- Extract only Workflow(Agent) and Copilot ---- #}\r\n{% set workflow_input = (input_data | selectattr(\"request_type\", \"equalto\", \"Agent\") | list) %}\r\n{% set workflow_output = (output_data | selectattr(\"request_type\", \"equalto\", \"Agent\") | list) %}\r\n{% set workflow_cache = (cache_data | selectattr(\"request_type\", \"equalto\", \"Agent\") | list) %}\r\n\r\n{% set copilot_input = (input_data | selectattr(\"request_type\", \"equalto\", \"Copilot\") | list) %}\r\n{% set copilot_output = (output_data | selectattr(\"request_type\", \"equalto\", \"Copilot\") | list) %}\r\n{% set copilot_cache = (cache_data | selectattr(\"request_type\", \"equalto\", \"Copilot\") | list) %}\r\n<div style=\"font-family: Arial, sans-serif; font-size: 14px; margin: 10px; color:#ffffff;\">\r\n\r\n  <div style=\"display: flex; gap: 16px; flex-wrap: wrap; background:transparent; padding:16px; border-radius:10px; max-height: 240px;\">\r\n    \r\n    <!-- Workflow Card -->\r\n    <div style=\"flex:1; background:transparent; padding:14px; border-radius:10px;\">\r\n      <h3 style=\"margin-top:0; font-size:16px; color:#ffffff;\">Average Tokens for Workflow</h3>\r\n      <div style=\"display: flex; gap: 10px;\">\r\n        <div style=\"flex:1; background:transparent; padding:10px; border-radius:8px; text-align:center;\">\r\n          <b style=\"color:#ffffff;\">Input Tokens</b><br>\r\n          <span style=\"color:#ffffff; font-weight:bold;\">\r\n            {{ (workflow_input[0].token_usage_input_tokens_avg|round(2) if workflow_input|length > 0 else 0) }}\r\n          </span>\r\n        </div>\r\n        <div style=\"flex:1; background:transparent; padding:10px; border-radius:8px; text-align:center;\">\r\n          <b style=\"color:#ffffff;\">Output Tokens</b><br>\r\n          <span style=\"color:#ffffff; font-weight:bold;\">\r\n            {{ (workflow_output[0].token_usage_output_tokens_avg|round(2) if workflow_output|length > 0 else 0) }}\r\n          </span>\r\n        </div>\r\n        <div style=\"flex:1; background:transparent; padding:10px; border-radius:8px; text-align:center;\">\r\n          <b style=\"color:#ffffff;\">Cache Tokens</b><br>\r\n          <span style=\"color:#ffffff; font-weight:bold;\">\r\n            {{ (workflow_cache[0].token_usage_cache_tokens_avg|round(2) if workflow_cache|length > 0 else 0) }}\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Copilot Card -->\r\n    <div style=\"flex:1; background:transparent; padding:14px; border-radius:10px;\">\r\n      <h3 style=\"margin-top:0; font-size:16px; color:#ffffff;\">Average tokens for Copilot</h3>\r\n      <div style=\"display: flex; gap: 10px;\">\r\n        <div style=\"flex:1; background:transparent; padding:10px; border-radius:8px; text-align:center;\">\r\n          <b style=\"color:#ffffff;\">Input Tokens</b><br>\r\n          <span style=\"color:#ffffff; font-weight:bold;\">\r\n            {{ (copilot_input[0].token_usage_input_tokens_avg|round(2) if copilot_input|length > 0 else 0) }}\r\n          </span>\r\n        </div>\r\n        <div style=\"flex:1; background:transparent; padding:10px; border-radius:8px; text-align:center;\">\r\n          <b style=\"color:#ffffff;\">Output Tokens</b><br>\r\n          <span style=\"color:#ffffff; font-weight:bold;\">\r\n            {{ (copilot_output[0].token_usage_output_tokens_avg|round(2) if copilot_output|length > 0 else 0) }}\r\n          </span>\r\n        </div>\r\n        <div style=\"flex:1; background:transparent; padding:10px; border-radius:8px; text-align:center;\">\r\n          <b style=\"color:#ffffff;\">Cache Tokens</b><br>\r\n          <span style=\"color:#ffffff; font-weight:bold;\">\r\n            {{ (copilot_cache[0].token_usage_cache_tokens_avg|round(2) if copilot_cache|length > 0 else 0) }}\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n</div>\r\n{% endraw %}\r\n"
        },
        {
            "name": "token_count",
            "value": "{% raw %}\r\n{# ---- Query Aggregates ---- #}\r\n{% set input_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    aggs=[{\"field\": \"token_usage_input_tokens\", \"func\": \"avg\"}],\r\n    groupby=[\"request_type\"],\r\n    duration_hours=1800000,\r\n    ts_column=\"timestamp\"\r\n) %}\r\n\r\n{% set output_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    aggs=[{\"field\": \"token_usage_output_tokens\", \"func\": \"avg\"}],\r\n    groupby=[\"request_type\"],\r\n    duration_hours=1800000,\r\n    ts_column=\"timestamp\"\r\n) %}\r\n\r\n{% set cache_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    aggs=[{\"field\": \"token_usage_cache_tokens\", \"func\": \"avg\"}],\r\n    groupby=[\"request_type\"],\r\n    duration_hours=1800000,\r\n    ts_column=\"timestamp\"\r\n) %}\r\n\r\n{# ---- Extract only Workflow(Agent) and Copilot ---- #}\r\n{% set workflow_input = (input_data | selectattr(\"request_type\", \"equalto\", \"Agent\") | list) %}\r\n{% set workflow_output = (output_data | selectattr(\"request_type\", \"equalto\", \"Agent\") | list) %}\r\n{% set workflow_cache = (cache_data | selectattr(\"request_type\", \"equalto\", \"Agent\") | list) %}\r\n\r\n{% set copilot_input = (input_data | selectattr(\"request_type\", \"equalto\", \"Copilot\") | list) %}\r\n{% set copilot_output = (output_data | selectattr(\"request_type\", \"equalto\", \"Copilot\") | list) %}\r\n{% set copilot_cache = (cache_data | selectattr(\"request_type\", \"equalto\", \"Copilot\") | list) %}\r\n\r\n<div style=\"font-family: Arial, sans-serif; font-size: 14px; margin: 10px;\">\r\n\r\n  <div style=\"display: flex; gap: 16px; flex-wrap: wrap; background:#1e293b; padding:16px; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.3); max-height: 240px;\">\r\n    \r\n    <!-- Workflow Card -->\r\n    <div style=\"flex:1; background:#111827; padding:14px; border-radius:10px; box-shadow:0 1px 4px rgba(0,0,0,0.5);\">\r\n      <h3 style=\"margin-top:0; color:#f8fafc; font-size:16px; text-align:center;\">Average Tokens for Workflow</h3>\r\n      <div style=\"display: flex; gap: 10px;\">\r\n        <div style=\"flex:1; background:#1f2937; padding:10px; border-radius:8px; text-align:center;\">\r\n          <b style=\"color:#f1f5f9;\">Input Tokens</b><br>\r\n          <span style=\"color:#60a5fa; font-weight:bold;\">\r\n            {{ (workflow_input[0].token_usage_input_tokens_avg|round(2) if workflow_input|length > 0 else 0) }}\r\n          </span>\r\n        </div>\r\n        <div style=\"flex:1; background:#1f2937; padding:10px; border-radius:8px; text-align:center;\">\r\n          <b style=\"color:#f1f5f9;\">Output Tokens</b><br>\r\n          <span style=\"color:#34d399; font-weight:bold;\">\r\n            {{ (workflow_output[0].token_usage_output_tokens_avg|round(2) if workflow_output|length > 0 else 0) }}\r\n          </span>\r\n        </div>\r\n        <div style=\"flex:1; background:#1f2937; padding:10px; border-radius:8px; text-align:center;\">\r\n          <b style=\"color:#f1f5f9;\">Cache Tokens</b><br>\r\n          <span style=\"color:#facc15; font-weight:bold;\">\r\n            {{ (workflow_cache[0].token_usage_cache_tokens_avg|round(2) if workflow_cache|length > 0 else 0) }}\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Copilot Card -->\r\n    <div style=\"flex:1; background:#111827; padding:14px; border-radius:10px; box-shadow:0 1px 4px rgba(0,0,0,0.5);\">\r\n      <h3 style=\"margin-top:0; color:#f8fafc; font-size:16px; text-align:center;\">Average Tokens for Fabaio</h3>\r\n      <div style=\"display: flex; gap: 10px;\">\r\n        <div style=\"flex:1; background:#1f2937; padding:10px; border-radius:8px; text-align:center;\">\r\n          <b style=\"color:#f1f5f9;\">Input Tokens</b><br>\r\n          <span style=\"color:#60a5fa; font-weight:bold;\">\r\n            {{ (copilot_input[0].token_usage_input_tokens_avg|round(2) if copilot_input|length > 0 else 0) }}\r\n          </span>\r\n        </div>\r\n        <div style=\"flex:1; background:#1f2937; padding:10px; border-radius:8px; text-align:center;\">\r\n          <b style=\"color:#f1f5f9;\">Output Tokens</b><br>\r\n          <span style=\"color:#34d399; font-weight:bold;\">\r\n            {{ (copilot_output[0].token_usage_output_tokens_avg|round(2) if copilot_output|length > 0 else 0) }}\r\n          </span>\r\n        </div>\r\n        <div style=\"flex:1; background:#1f2937; padding:10px; border-radius:8px; text-align:center;\">\r\n          <b style=\"color:#f1f5f9;\">Cache Tokens</b><br>\r\n          <span style=\"color:#facc15; font-weight:bold;\">\r\n            {{ (copilot_cache[0].token_usage_cache_tokens_avg|round(2) if copilot_cache|length > 0 else 0) }}\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n</div>\r\n{% endraw %}\r\n"
        }
    ]
}