{
    "name": "model_comparison_main",
    "description": "Model Comparison Storyboard",
    "label": "Model Comparison",
    "enabled": true,
    "dashboard_folder": "Default",
    "live_edit": true,
    "dashboard_style": "auto",
    "dashboard_type": "dashboard",
    "use_storyboard": true,
    "template_variables": {
        "conversationId": {
            "contextId": "conversationId"
        }
    },
    "custom_widgets": {
        "ai_persona": {
            "artifacts": {
                "main": {
                    "attachment": "ai_persona",
                    "content_type": "text/html",
                    "is_template": true
                }
            }
        },
        "selected_llm": {
            "artifacts": {
                "main": {
                    "attachment": "selected_llm",
                    "content_type": "text/html",
                    "is_template": true
                }
            }
        },
        "test_prompt": {
            "artifacts": {
                "main": {
                    "attachment": "test_prompt",
                    "content_type": "text/html",
                    "is_template": true
                }
            }
        },
        "output_ah": {
            "artifacts": {
                "main": {
                    "attachment": "output_ah",
                    "content_type": "text/html",
                    "is_template": true
                }
            }
        },
        "output_rating_ah": {
            "artifacts": {
                "main": {
                    "attachment": "output_rating_ah",
                    "content_type": "text/html",
                    "is_template": true
                }
            }
        }
    },
    "default_storyboard": "Metrics Comparison",
    "dashboard_sections": [
        {
            "title": "",
            "widgets": [
                {
                    "title": "AI Persona",
                    "widget_type": "label",
                    "label": "attachment://ai_persona",
                    "uses_reporting_engine": true,
                    "min_width": 12,
                    "max_width": 12,
                    "height": 6,
                    "advanced": true,
                    "widget_id": "a20a7370"
                },
                {
                    "title": "Selected LLM",
                    "widget_type": "label",
                    "label": "attachment://selected_llm",
                    "uses_reporting_engine": true,
                    "min_width": 12,
                    "max_width": 12,
                    "height": 6,
                    "advanced": true,
                    "widget_id": "5244bacd"
                },
                {
                    "title": "Metrics Comparison",
                    "widget_type": "label",
                    "label": "attachment://output_ah_new",
                    "uses_reporting_engine": true,
                    "min_width": 12,
                    "max_width": 12,
                    "height": 6,
                    "advanced": true,
                    "widget_id": "31bcbd5c"
                },
                {
                    "title": "Test Prompt",
                    "widget_type": "label",
                    "label": "attachment://test_prompt",
                    "uses_reporting_engine": true,
                    "min_width": 12,
                    "max_width": 12,
                    "height": 6,
                    "advanced": true,
                    "widget_id": "ea79f8df"
                },
                {
                    "title": "Output",
                    "widget_type": "label",
                    "label": "attachment://output_ah",
                    "uses_reporting_engine": true,
                    "min_width": 12,
                    "max_width": 12,
                    "height": 6,
                    "advanced": true,
                    "widget_id": "d86db31b"
                },
                {
                    "title": "Output",
                    "widget_type": "label",
                    "label": "attachment://output_rating_ah",
                    "uses_reporting_engine": true,
                    "min_width": 12,
                    "max_width": 12,
                    "height": 6,
                    "advanced": true,
                    "widget_id": "d86db31k"
                }
            ]
        }
    ],
    "saved_time": "2025-12-06T07:26:20.454757",
    "attachments": [
        {
            "name": "ai_persona",
            "value": "{% set cfxql_pass_query = \"parentConversationId is '\" ~ context.conversationId ~\"' and isModelComparison is not empty\" %}\r\n{% set all_data = engine.query_stream_aggs(stream=\"rda_chat_sessions\", cfxql_query=cfxql_pass_query,aggs=[{\"field\":\"persona\",\"func\":\"value_count\"}],groupby=[\"persona\"])%}\r\n\r\n<div style=\"width: 100%; height: 100%; background: transparent; display: flex; gap: 10px; align-items: center; overflow-x: auto\">\r\n    {% for data in all_data %}\r\n        {% set persona = data.persona %}\r\n        <div>\r\n            <p style=\"font-size: 18px; font-weight: bold; align-items: center; color: green; margin: 0; height: 30px\">{{ persona }}</p>\r\n            \r\n        </div>\r\n    {% endfor %}\r\n</div>\r\n\r\n"
        },
        {
            "name": "selected_llm",
            "value": "{% set cfxql_pass_query = \"parentConversationId is '\" ~ context.conversationId ~\"' and isModelComparison is not empty\" %}\r\n{% set all_data = engine.query_stream_aggs(stream=\"rda_chat_sessions\", cfxql_query=cfxql_pass_query,aggs=[{\"field\":\"llm\",\"func\":\"value_count\"}],groupby=[\"llm\"])%}\r\n\r\n<div style=\"width: 100%; height: 100%; background: transparent; display: flex; gap: 10px; align-items: center; overflow-x: auto\">\r\n    {% for data in all_data %}\r\n        {% set llm_name = data.llm %}\r\n        <div style=\"min-width: 120px; width: 100px; max-width: 120px; height: 75px; background: #1c1e22; padding: 4px; border-radius: 6px; text-align: center; overflow: hidden\">\r\n            <p style=\"font-size: 18px; font-weight: bold; color: #cccccc; margin: 0; height: 30px\">{{ llm_name }}</p>\r\n            \r\n        </div>\r\n    {% endfor %}\r\n</div>\r\n"
        },
        {
            "name": "test_prompt",
            "value": "{% set cfxql_pass_query = \"parentConversationId is '\" ~ context.conversationId ~\"' and type == 'client'\" %}\r\n{% set all_data = engine.query_stream_aggs(stream=\"rda_chat_sessions\", cfxql_query=cfxql_pass_query,aggs=[{\"field\":\"message\",\"func\":\"value_count\"}],groupby=[\"message\"])%}\r\n\r\n<div style=\"width: 100%; height: 100%; background: transparent; display: flex; gap: 10px; align-items: center; overflow-x: auto\">\r\n    {% for data in all_data %}\r\n        {% set prompt = data.message %}\r\n        <div>\r\n            <p style=\"font-size: 15px; font-weight: bold; align-items: center; color: yellow; margin: 0; height: 30px\">{{ prompt }}</p>\r\n            \r\n        </div>\r\n    {% endfor %}\r\n</div>\r\n\r\n"
        },
        {
            "name": "output_ah_bkp",
            "value": "{% set cfxql_pass_query = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty\" %}\r\n{% set cfxql_pass_query_tool_count = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty and tool_name is not empty\" %}\r\n{% set cfxql_pass_query_output = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty and type == 'openai' and tool_content is empty and tool_name is empty\" %}\r\n\r\n{% set all_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\", \r\n    cfxql_query=cfxql_pass_query, \r\n    aggs=[{\"field\": \"conversationId\", \"func\": \"value_count\"}], \r\n    groupby=[\"llm\"]\r\n) %}\r\n\r\n{% set input_token_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\", \r\n    cfxql_query=cfxql_pass_query, \r\n    aggs=[{\"field\": \"token_usage_input_tokens\", \"func\": \"sum\"}], \r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set output_token_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\", \r\n    cfxql_query=cfxql_pass_query, \r\n    aggs=[{\"field\": \"token_usage_output_tokens\", \"func\": \"sum\"}], \r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set total_token_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\", \r\n    cfxql_query=cfxql_pass_query, \r\n    aggs=[{\"field\": \"token_usage_total_tokens\", \"func\": \"sum\"}], \r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set tool_count = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\", \r\n    cfxql_query=cfxql_pass_query_tool_count, \r\n    aggs=[{\"field\": \"count_\", \"func\": \"sum\"}], \r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set llm_output = engine.query_stream_data(\r\n    stream=\"rda_chat_sessions\", \r\n    cfxql_query=cfxql_pass_query_output, \r\n    limit=100\r\n) %}\r\n\r\n{% set costs = {\r\n  \"gpt-4o\": [2.5, 10],\r\n  \"gpt-4.1\": [2, 8],\r\n  \"gpt-4.1-mini\": [0.4, 1.6],\r\n  \"O3-mini\": [1.1, 4.4],\r\n  \"claude-sonnet-4\": [3, 15],\r\n  \"claude-haiku-3.5\": [0.8, 4]\r\n} %}\r\n\r\n{% set merged_data = [] %}\r\n{% for row in all_data %}\r\n  {% set llm = row.llm %}\r\n  {% set input_match = input_token_data | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n  {% set output_match = output_token_data | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n  {% set tool_count_match = tool_count | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n  {% set msg_match = llm_output | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n\r\n  {% set input = input_match[0].token_usage_input_tokens_sum if input_match else 0 %}\r\n  {% set output = output_match[0].token_usage_output_tokens_sum if output_match else 0 %}\r\n  {% set tools = tool_count_match[0].count__sum if tool_count_match else 0 %}\r\n  {% set message_raw = msg_match[0].message if msg_match else '' %}\r\n  {% set clean_message = message_raw | replace('\\n', ' ') | trim %}\r\n  {% set total = input + output %}\r\n\r\n  {% set input_cost = (input / 1_000_000) * (costs[llm][0] if llm in costs else 0) %}\r\n  {% set output_cost = (output / 1_000_000) * (costs[llm][1] if llm in costs else 0) %}\r\n  {% set total_cost = input_cost + output_cost %}\r\n\r\n  {% set updated_row = {\r\n    \"llm\": llm,\r\n    \"parentConversationId_value_count\": row.parentConversationId_value_count,\r\n    \"token_usage_input_tokens\": input | int,\r\n    \"token_usage_output_tokens\": output | int,\r\n    \"token_usage_total_tokens\": total | int,\r\n    \"tool_count\": tools | int,\r\n    \"output\": clean_message,\r\n    \"input_cost\": input_cost | round(4),\r\n    \"output_cost\": output_cost | round(4),\r\n    \"total_cost\": total_cost | round(4)\r\n  } %}\r\n  {% set _ = merged_data.append(updated_row) %}\r\n{% endfor %}\r\n\r\n<h2 style=\"color: white; font-size: 24px; text-align: center;\">LLM Output Summary</h2>\r\n\r\n<div style=\"\r\n  width: 100%;\r\n  overflow-x: auto;\r\n  padding: 30px 40px;\r\n  box-sizing: border-box;\r\n\">\r\n  <div style=\"\r\n    display: flex;\r\n    flex-direction: row;\r\n    gap: 30px;\r\n    flex-wrap: nowrap;\r\n    justify-content: space-around;\r\n    align-items: flex-start;\r\n    min-width: max-content;\r\n  \">\r\n    {% for data in merged_data %}\r\n      <div style=\"\r\n        min-width: 360px;\r\n        max-width: 360px;\r\n        height: 400px;\r\n        background: #1c1e22;\r\n        border-radius: 14px;\r\n        color: white;\r\n        font-family: sans-serif;\r\n        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);\r\n        display: flex;\r\n        flex-direction: column;\r\n        padding: 20px;\r\n        flex-shrink: 0;\r\n      \">\r\n        <div style=\"flex: 0 0 auto;\">\r\n          <p style=\"font-size: 22px; font-weight: bold; text-align: center; margin-bottom: 12px;\">{{ data.llm or \"Model\" }}</p>\r\n          <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Input Tokens:</strong> {{ \"{:,}\".format(data.token_usage_input_tokens) }}</p>\r\n          <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Output Tokens:</strong> {{ \"{:,}\".format(data.token_usage_output_tokens) }}</p>\r\n          <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Total Tokens:</strong> {{ \"{:,}\".format(data.token_usage_total_tokens) }}</p>\r\n          <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Tools Called:</strong> {{ \"{:,}\".format(data.tool_count) }}</p>\r\n          <hr style=\"border-color: #444; margin: 8px 0;\">\r\n          <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Input Cost:</strong> ${{ data.input_cost }}</p>\r\n          <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Output Cost:</strong> ${{ data.output_cost }}</p>\r\n          <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Total Cost:</strong> ${{ data.total_cost }}</p>\r\n          <p style=\"margin: 4px 0;\"><strong>Output:</strong></p>\r\n        </div>\r\n\r\n        <div style=\"\r\n          flex-grow: 1;\r\n          overflow-y: auto;\r\n          font-size: 13px;\r\n          white-space: pre-wrap;\r\n          padding-right: 6px;\r\n          padding-bottom: 12px;\r\n          margin-top: 4px;\r\n          border-top: 1px solid #333;\r\n        \">\r\n          {{ data.output or \"No output found\" }}\r\n        </div>\r\n      </div>\r\n    {% endfor %}\r\n  </div>\r\n</div>\r\n"
        },
        {
            "name": "output_rating_ah",
            "value": "{# Backend Scoring & Processing Logic #}\r\n{% set expected_tool_calls = 10 %}\r\n{% set cfxql_pass_query = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty\" %}\r\n{% set cfxql_pass_query_tool_count = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty and tool_name is not empty\" %}\r\n{% set cfxql_pass_query_output = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty and type == 'openai' and tool_content is empty and tool_name is empty\" %}\r\n\r\n{% set all_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\", \r\n    cfxql_query=cfxql_pass_query, \r\n    aggs=[{\"field\": \"conversationId\", \"func\": \"value_count\"}], \r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set input_token_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\", \r\n    cfxql_query=cfxql_pass_query, \r\n    aggs=[{\"field\": \"token_usage_input_tokens\", \"func\": \"sum\"}], \r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set output_token_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\", \r\n    cfxql_query=cfxql_pass_query, \r\n    aggs=[{\"field\": \"token_usage_output_tokens\", \"func\": \"sum\"}], \r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set total_token_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\", \r\n    cfxql_query=cfxql_pass_query, \r\n    aggs=[{\"field\": \"token_usage_total_tokens\", \"func\": \"sum\"}], \r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set tool_count = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\", \r\n    cfxql_query=cfxql_pass_query_tool_count, \r\n    aggs=[{\"field\": \"count_\", \"func\": \"sum\"}], \r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set llm_output = engine.query_stream_data(\r\n    stream=\"rda_chat_sessions\", \r\n    cfxql_query=cfxql_pass_query_output, \r\n    limit=100\r\n) %}\r\n{% set costs = {\"gpt-4o\": [2.5, 10], \"gpt-4.1\": [2, 8], \"gpt-4.1-mini\": [0.4, 1.6], \"O3-mini\": [1.1, 4.4], \"claude-sonnet-4\": [3, 15], \"claude-haiku-3.5\": [0.8, 4]} %}\r\n\r\n{% set output_list = llm_output | map(attribute='message') | list %}\r\n{% set all_tokens = [] %}\r\n{% for message in output_list %}\r\n  {% for word in message.split() %}\r\n    {% set word_clean = word | lower %}\r\n    {% if word_clean not in all_tokens %}\r\n      {% set _ = all_tokens.append(word_clean) %}\r\n    {% endif %}\r\n  {% endfor %}\r\n{% endfor %}\r\n\r\n{% set enriched_data = [] %}\r\n{% for row in all_data %}\r\n  {% set llm = row.llm %}\r\n  {% set input = (input_token_data | selectattr(\"llm\", \"equalto\", llm) | list)[0].token_usage_input_tokens_sum if input_token_data | selectattr(\"llm\", \"equalto\", llm) | list else 0 %}\r\n  {% set output = (output_token_data | selectattr(\"llm\", \"equalto\", llm) | list)[0].token_usage_output_tokens_sum if output_token_data | selectattr(\"llm\", \"equalto\", llm) | list else 0 %}\r\n  {% set tools = (tool_count | selectattr(\"llm\", \"equalto\", llm) | list)[0].count__sum if tool_count | selectattr(\"llm\", \"equalto\", llm) | list else 0 %}\r\n  {% set msg_raw = (llm_output | selectattr(\"llm\", \"equalto\", llm) | list)[0].message if llm_output | selectattr(\"llm\", \"equalto\", llm) | list else '' %}\r\n  {% set msg = msg_raw | replace('\\n', ' ') | trim %}\r\n\r\n  {% set tokenized = [] %}\r\n  {% for w in msg.split() %}\r\n    {% set wclean = w | lower %}\r\n    {% if wclean not in tokenized %}{% set _ = tokenized.append(wclean) %}{% endif %}\r\n  {% endfor %}\r\n  {% set match_count = 0 %}\r\n  {% for word in all_tokens %}\r\n    {% if word in tokenized %}{% set match_count = match_count + 1 %}{% endif %}\r\n  {% endfor %}\r\n  {% set union_count = (tokenized | length) + (all_tokens | length) - match_count %}\r\n  {% set domain_coverage_score = (match_count / union_count) if union_count > 0 else 0 %}\r\n\r\n  {% set total = input + output %}\r\n  {% set input_cost = (input / 1_000_000) * (costs[llm][0] if llm in costs else 0) %}\r\n  {% set output_cost = (output / 1_000_000) * (costs[llm][1] if llm in costs else 0) %}\r\n  {% set total_cost = input_cost + output_cost %}\r\n  {% set output_ratio = (output / total) if total > 0 else 0 %}\r\n  {% set tool_score = 1 - ((tools - expected_tool_calls) | abs / expected_tool_calls) %}\r\n  {% set tool_score = tool_score if tool_score >= 0 else 0 %}\r\n  {% set cost_score = (1 / (1 + total_cost)) %}\r\n  {% set score = (domain_coverage_score * 0.6 + (output_ratio * 0.1333 + tool_score * 0.1333 + cost_score * 0.1333)) | round(4) %}\r\n\r\n  {% set _ = enriched_data.append({\r\n    \"llm\": llm,\r\n    \"input\": input,\r\n    \"output\": output,\r\n    \"total\": total,\r\n    \"tools\": tools,\r\n    \"input_cost\": input_cost | round(4),\r\n    \"output_cost\": output_cost | round(4),\r\n    \"total_cost\": total_cost | round(4),\r\n    \"output_msg\": msg,\r\n    \"domain_coverage_score\": domain_coverage_score | round(4),\r\n    \"score\": score\r\n  }) %}\r\n{% endfor %}\r\n\r\n{# Normalize scores to 1\u20135 stars #}\r\n{% set score_values = enriched_data | map(attribute=\"score\") | list %}\r\n{% set min_score = score_values | min %}\r\n{% set max_score = score_values | max %}\r\n{% for row in enriched_data %}\r\n  {% set norm_score = ((row.score - min_score) / (max_score - min_score + 0.0001)) %}\r\n  {% set star_rating = (norm_score * 4 + 1) | round(2) %}\r\n  {% set _ = row.update({\"star_rating\": star_rating}) %}\r\n{% endfor %}\r\n{% set best_star = enriched_data | max(attribute=\"star_rating\") %}\r\n\r\n<h2 style=\"color: white; font-size: 24px; text-align: center;\">LLM Output Scorecard</h2>\r\n<div style=\"width: 100%; overflow-x: auto; padding: 30px 40px; box-sizing: border-box;\">\r\n  <div style=\"display: flex; flex-direction: row; gap: 30px; flex-wrap: nowrap; justify-content: space-around; align-items: flex-start; min-width: max-content;\">\r\n    {% for data in enriched_data %}\r\n      <div style=\"\r\n        min-width: 340px;\r\n        max-width: 340px;\r\n        height: 420px;\r\n        overflow: hidden;\r\n        background: {% if data.star_rating == best_star.star_rating %}#283618{% else %}#1c1e22{% endif %};\r\n        border-radius: 10px;\r\n        color: white;\r\n        font-family: sans-serif;\r\n        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);\r\n        display: flex;\r\n        flex-direction: column;\r\n        padding: 12px;\r\n        flex-shrink: 0;\r\n        border: 2px solid {% if data.star_rating == best_star.star_rating %}lime{% else %}#333{% endif %};\r\n      \">\r\n        <div style=\"flex: 0 0 auto;\">\r\n          <p style=\"font-size: 18px; font-weight: bold; text-align: center; margin-bottom: 8px;\">\r\n            {{ data.llm or \"Model\" }}<br>\r\n            <span style=\"font-size: 14px; color: gold;\">\u2b50 {{ data.star_rating }} / 5</span>\r\n          </p>\r\n          <p style=\"margin: 3px 0; font-size: 12px;\"><strong>Input Tokens:</strong> {{ data.input }}</p>\r\n          <p style=\"margin: 3px 0; font-size: 12px;\"><strong>Output Tokens:</strong> {{ data.output }}</p>\r\n          <p style=\"margin: 3px 0; font-size: 12px;\"><strong>Total Tokens:</strong> {{ data.total }}</p>\r\n          <p style=\"margin: 3px 0; font-size: 12px;\"><strong>Tools Called:</strong> {{ data.tools }}</p>\r\n          <p style=\"margin: 3px 0; font-size: 12px;\"><strong>Input Cost:</strong> ${{ data.input_cost }}</p>\r\n          <p style=\"margin: 3px 0; font-size: 12px;\"><strong>Output Cost:</strong> ${{ data.output_cost }}</p>\r\n          <p style=\"margin: 3px 0; font-size: 12px;\"><strong>Total Cost:</strong> ${{ data.total_cost }}</p>\r\n          <p style=\"margin: 6px 0 3px 0;\"><strong>Output:</strong></p>\r\n        </div>\r\n        <div style=\"\r\n          flex-grow: 1;\r\n          overflow-y: auto;\r\n          font-size: 11px;\r\n          white-space: pre-wrap;\r\n          padding-right: 4px;\r\n          padding-bottom: 8px;\r\n          margin-top: 4px;\r\n          border-top: 1px solid #333;\r\n          max-height: 160px;\r\n        \">\r\n          {{ data.output_msg or \"No output found\" }}\r\n        </div>\r\n      </div>\r\n    {% endfor %}\r\n  </div>\r\n</div>\r\n"
        },
        {
            "name": "output_ah_bkp1",
            "value": "{% set cfxql_pass_query = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty\" %}\r\n{% set cfxql_pass_query_tool_count = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty and tool_name is not empty\" %}\r\n{% set cfxql_pass_query_output = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty and type == 'openai' and tool_content is empty and tool_name is empty\" %}\r\n\r\n{# Aggregate queries #}\r\n{% set all_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query,\r\n    aggs=[\r\n        {\"field\": \"conversationId\", \"func\": \"value_count\"},\r\n        {\"field\": \"conversation_start_time\", \"func\": \"min\"},\r\n        {\"field\": \"conversation_end_time\", \"func\": \"max\"}\r\n    ],\r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set input_token_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query,\r\n    aggs=[{\"field\": \"token_usage_input_tokens\", \"func\": \"sum\"}],\r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set output_token_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query,\r\n    aggs=[{\"field\": \"token_usage_output_tokens\", \"func\": \"sum\"}],\r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set tool_count = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query_tool_count,\r\n    aggs=[{\"field\": \"count_\", \"func\": \"sum\"}],\r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set llm_output = engine.query_stream_data(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query_output,\r\n    limit=100\r\n) %}\r\n\r\n{% set costs = {\r\n    \"gpt-4o\": [2.5, 10],\r\n    \"gpt-4.1\": [2, 8],\r\n    \"gpt-4.1-mini\": [0.4, 1.6],\r\n    \"O3-mini\": [1.1, 4.4],\r\n    \"claude-sonnet-4\": [3, 15],\r\n    \"claude-haiku-3.5\": [0.8, 4]\r\n} %}\r\n\r\n{% set merged_data = [] %}\r\n{% for row in all_data %}\r\n    {% set llm = row.llm %}\r\n    {% set input_match = input_token_data | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n    {% set output_match = output_token_data | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n    {% set tool_count_match = tool_count | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n    {% set msg_match = llm_output | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n\r\n    {% set input = input_match[0].token_usage_input_tokens_sum if input_match else 0 %}\r\n    {% set output = output_match[0].token_usage_output_tokens_sum if output_match else 0 %}\r\n    {% set tools = tool_count_match[0].count__sum if tool_count_match else 0 %}\r\n    {% set message_raw = msg_match[0].message if msg_match else '' %}\r\n    {% set clean_message = message_raw | replace('\\n', ' ') | trim %}\r\n    {% set total = input + output %}\r\n\r\n    {% set input_cost = (input / 1_000_000) * (costs[llm][0] if llm in costs else 0) %}\r\n    {% set output_cost = (output / 1_000_000) * (costs[llm][1] if llm in costs else 0) %}\r\n    {% set total_cost = input_cost + output_cost %}\r\n\r\n    {% set updated_row = {\r\n        \"llm\": llm,\r\n        \"token_usage_input_tokens\": input | int,\r\n        \"token_usage_output_tokens\": output | int,\r\n        \"token_usage_total_tokens\": total | int,\r\n        \"tool_count\": tools | int,\r\n        \"output\": clean_message,\r\n        \"input_cost\": input_cost | round(4),\r\n        \"output_cost\": output_cost | round(4),\r\n        \"total_cost\": total_cost | round(4)\r\n    } %}\r\n    {% set _ = merged_data.append(updated_row) %}\r\n{% endfor %}\r\n\r\n<h2 style=\"color: white; font-size: 24px; text-align: center;\">LLM Output Summary</h2>\r\n<div style=\"width: 100%; overflow-x: auto; padding: 30px 40px; box-sizing: border-box;\">\r\n    <div style=\"display: flex; flex-direction: row; gap: 30px; flex-wrap: nowrap; align-items: flex-start; min-width: max-content;\">\r\n        {% for data in merged_data %}\r\n        <div style=\"min-width: 450px; max-width: 550px; height: calc(100vh - 150px); background: #1c1e22; border-radius: 14px; color: white; font-family: sans-serif; box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4); display: flex; flex-direction: column; padding: 20px; flex-shrink: 0;\">\r\n            \r\n            <div style=\"flex: 0 0 auto;\">\r\n                <p style=\"font-size: 22px; font-weight: bold; text-align: center; margin-bottom: 12px;\">{{ data.llm or \"Model\" }}</p>\r\n\r\n                <div style=\"display: flex; justify-content: space-between; gap: 10px; margin-top: 8px;\">\r\n                    <div style=\"flex: 1;\">\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Input Tokens:</strong> {{ \"{:,}\".format(data.token_usage_input_tokens) }}</p>\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Output Tokens:</strong> {{ \"{:,}\".format(data.token_usage_output_tokens) }}</p>\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Total Tokens:</strong> {{ \"{:,}\".format(data.token_usage_total_tokens) }}</p>\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Tools:</strong> {{ \"{:,}\".format(data.tool_count) }}</p>\r\n                    </div>\r\n\r\n                    <div style=\"border-left: 1px solid #555; padding-left: 10px; flex: 1;\">\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Input Cost:</strong> ${{ data.input_cost }}</p>\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Output Cost:</strong> ${{ data.output_cost }}</p>\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Total Cost:</strong> ${{ data.total_cost }}</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <hr style=\"margin: 15px 0; border: none; border-top: 1px solid #444;\">\r\n            <hr style=\"margin: 15px 0; border: none; border-top: 1px solid #444;\">\r\n            \r\n            <div style=\"flex-grow: 1; overflow-y: auto; background: #2a2d33; border-radius: 10px; padding: 12px; font-size: 13px; white-space: pre-wrap; border: 1px solid #444; box-shadow: inset 0 2px 4px rgba(0,0,0,0.4);\">\r\n                {{ data.output or \"No output found\" }}\r\n            </div>\r\n        </div>\r\n        {% endfor %}\r\n    </div>\r\n</div>\r\n"
        },
        {
            "name": "output_ah_1",
            "value": "{% set cfxql_pass_query = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty\" %}\r\n{% set cfxql_pass_query_tool_count = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty and tool_name is not empty\" %}\r\n{% set cfxql_pass_query_output = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty and type == 'Assistant' and tool_content is empty and tool_name is empty\" %}\r\n\r\n{# Aggregate queries #}\r\n{% set all_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query,\r\n    aggs=[\r\n        {\"field\": \"conversationId\", \"func\": \"value_count\"},\r\n        {\"field\": \"timestamp\", \"func\": \"min\"},\r\n        {\"field\": \"timestamp\", \"func\": \"max\"}\r\n    ],\r\n    groupby=[\"llm\"]\r\n) %}\r\n\r\n{% set input_token_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query,\r\n    aggs=[{\"field\": \"token_usage_input_tokens\", \"func\": \"sum\"}],\r\n    groupby=[\"llm\"]\r\n) %}\r\n\r\n{% set output_token_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query,\r\n    aggs=[{\"field\": \"token_usage_output_tokens\", \"func\": \"sum\"}],\r\n    groupby=[\"llm\"]\r\n) %}\r\n\r\n{% set tool_count = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query_tool_count,\r\n    aggs=[{\"field\": \"count_\", \"func\": \"sum\"}],\r\n    groupby=[\"llm\"]\r\n) %}\r\n\r\n{% set llm_output = engine.query_stream_data(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query_output,\r\n    limit=100\r\n) %}\r\n\r\n{% set llm_cost_query = ' * GET llm_name, input_token_cost_per1M, output_token_cost_per1M' %}\r\n{% set llm_costs = engine.query_stream_data(\r\n    \"llm_model_costs\",\r\n    cfxql_query=llm_cost_query,\r\n    sorting=[{\"llm_name\": \"asc\"}],\r\n    limit=100,\r\n    max_rows=100\r\n) %}\r\n{% set costs = {} %}\r\n{% for cost_row in llm_costs %}\r\n    {% set _ = costs.update({\r\n        cost_row.llm_name: [\r\n            cost_row.input_token_cost_per1M | float, \r\n            cost_row.output_token_cost_per1M | float\r\n        ]\r\n    }) %}\r\n{% endfor %}\r\n\r\n{% set merged_data = [] %}\r\n{% for row in all_data %}\r\n    {% set llm = row.llm %}\r\n    {% set input_match = input_token_data | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n    {% set output_match = output_token_data | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n    {% set tool_count_match = tool_count | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n    {% set msg_match = llm_output | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n\r\n    {% set input = input_match[0].token_usage_input_tokens_sum if input_match else 0 %}\r\n    {% set output = output_match[0].token_usage_output_tokens_sum if output_match else 0 %}\r\n    {% set tools = tool_count_match[0].count__sum if tool_count_match else 0 %}\r\n    {% set message_raw = msg_match[0].message if msg_match else '' %}\r\n    {% set clean_message = message_raw | replace('\\n', ' ') | trim %}\r\n    {% set total = input + output %}\r\n\r\n    {% set input_cost = (input / 1_000_000) * (costs[llm][0] if llm in costs else 0) %}\r\n    {% set output_cost = (output / 1_000_000) * (costs[llm][1] if llm in costs else 0) %}\r\n    {% set total_cost = input_cost + output_cost %}\r\n\r\n    {# Duration #}\r\n    {% set min_time = row.timestamp_min %}\r\n    {% set max_time = row.timestamp_max %}\r\n    {% set duration_seconds = (max_time - min_time) / 1000 %}\r\n    {% set hours = (duration_seconds // 3600) | int %}\r\n    {% set minutes = ((duration_seconds % 3600) // 60) | int %}\r\n    {% set seconds = (duration_seconds % 60) | int %}\r\n\r\n    {% set parts = [] %}\r\n    {% if hours > 0 %}{% set _ = parts.append(hours ~ \"h\") %}{% endif %}\r\n    {% if minutes > 0 %}{% set _ = parts.append(minutes ~ \"m\") %}{% endif %}\r\n    {% if seconds > 0 %}{% set _ = parts.append(seconds ~ \"s\") %}{% endif %}\r\n    {% if parts|length == 0 %}{% set _ = parts.append(\"0s\") %}{% endif %}\r\n    {% set duration_str = parts | join(\" \") %}\r\n\r\n    {# Safe fallback: show epoch timestamps #}\r\n    {% set min_iso = min_time %}\r\n    {% set max_iso = max_time %}\r\n\r\n    {% set updated_row = {\r\n        \"llm\": llm,\r\n        \"token_usage_input_tokens\": input | int,\r\n        \"token_usage_output_tokens\": output | int,\r\n        \"token_usage_total_tokens\": total | int,\r\n        \"tool_count\": tools | int,\r\n        \"output\": clean_message,\r\n        \"input_cost\": input_cost | round(4),\r\n        \"output_cost\": output_cost | round(4),\r\n        \"total_cost\": total_cost | round(4),\r\n        \"duration\": duration_str,\r\n        \"start_time_iso\": min_iso,\r\n        \"end_time_iso\": max_iso\r\n    } %}\r\n    {% set _ = merged_data.append(updated_row) %}\r\n{% endfor %}\r\n\r\n<h2 style=\"color: white; font-size: 24px; text-align: center;\">LLM Output Summary</h2>\r\n<div style=\"width: 100%; overflow-x: auto; padding: 30px 40px; box-sizing: border-box;\">\r\n    <div style=\"display: flex; flex-direction: row; gap: 30px; flex-wrap: nowrap; align-items: flex-start; min-width: max-content;\">\r\n        {% for data in merged_data %}\r\n        <div style=\"min-width: 450px; max-width: 550px; height: calc(100vh - 150px); background: #1c1e22; border-radius: 14px; color: white; font-family: sans-serif; box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4); display: flex; flex-direction: column; padding: 20px; flex-shrink: 0;\">\r\n            \r\n            <div style=\"flex: 0 0 auto;\">\r\n                <p style=\"font-size: 22px; font-weight: bold; text-align: center; margin-bottom: 12px;\">{{ data.llm or \"Model\" }}</p>\r\n\r\n                <div style=\"display: flex; justify-content: space-between; gap: 10px; margin-top: 8px;\">\r\n                    <div style=\"flex: 1;\">\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Input Tokens:</strong> {{ \"{:,}\".format(data.token_usage_input_tokens) }}</p>\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Output Tokens:</strong> {{ \"{:,}\".format(data.token_usage_output_tokens) }}</p>\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Total Tokens:</strong> {{ \"{:,}\".format(data.token_usage_total_tokens) }}</p>\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Tools:</strong> {{ \"{:,}\".format(data.tool_count) }}</p>\r\n                    </div>\r\n\r\n                    <div style=\"border-left: 1px solid #555; padding-left: 10px; flex: 1;\">\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Input Cost:</strong> ${{ data.input_cost }}</p>\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Output Cost:</strong> ${{ data.output_cost }}</p>\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Total Cost:</strong> ${{ data.total_cost }}</p>\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Duration:</strong> {{ data.duration }}</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <hr style=\"margin: 15px 0; border: none; border-top: 1px solid #444;\">\r\n            \r\n            <div style=\"flex-grow: 1; overflow-y: auto; background: #2a2d33; border-radius: 10px; padding: 12px; font-size: 13px; white-space: pre-wrap; border: 1px solid #444; box-shadow: inset 0 2px 4px rgba(0,0,0,0.4);\">\r\n                {{ data.output or \"No output found\" }}\r\n            </div>\r\n        </div>\r\n        {% endfor %}\r\n    </div>\r\n</div>\r\n"
        },
        {
            "name": "output_ah",
            "value": "{% set cfxql_pass_query = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty\" %}\r\n{% set cfxql_pass_query_tool_count = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty and tool_name is not empty\" %}\r\n{% set cfxql_pass_query_output = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty and type == 'Assistant' and tool_content is empty and tool_name is empty\" %}\r\n\r\n{# Aggregate queries #}\r\n{% set all_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query,\r\n    aggs=[\r\n        {\"field\": \"conversationId\", \"func\": \"value_count\"},\r\n        {\"field\": \"timestamp\", \"func\": \"min\"},\r\n        {\"field\": \"timestamp\", \"func\": \"max\"}\r\n    ],\r\n    groupby=[\"llm\"]\r\n) %}\r\n\r\n{% set input_token_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query,\r\n    aggs=[{\"field\": \"token_usage_input_tokens\", \"func\": \"sum\"}],\r\n    groupby=[\"llm\"]\r\n) %}\r\n\r\n{% set output_token_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query,\r\n    aggs=[{\"field\": \"token_usage_output_tokens\", \"func\": \"sum\"}],\r\n    groupby=[\"llm\"]\r\n) %}\r\n\r\n{% set tool_count = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query_tool_count,\r\n    aggs=[{\"field\": \"count_\", \"func\": \"sum\"}],\r\n    groupby=[\"llm\"]\r\n) %}\r\n\r\n{% set llm_output = engine.query_stream_data(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query_output,\r\n    limit=1000\r\n) %}\r\n\r\n{% set llm_cost_query = ' * GET llm_name, input_token_cost_per1M, output_token_cost_per1M' %}\r\n{% set llm_costs = engine.query_stream_data(\r\n    \"llm_model_costs\",\r\n    cfxql_query=llm_cost_query,\r\n    sorting=[{\"llm_name\": \"asc\"}],\r\n    limit=100,\r\n    max_rows=100\r\n) %}\r\n{% set costs = {} %}\r\n{% for cost_row in llm_costs %}\r\n    {% set _ = costs.update({\r\n        cost_row.llm_name: [\r\n            cost_row.input_token_cost_per1M | float, \r\n            cost_row.output_token_cost_per1M | float\r\n        ]\r\n    }) %}\r\n{% endfor %}\r\n\r\n{% set merged_data = [] %}\r\n{% for row in all_data %}\r\n    {% set llm = row.llm %}\r\n    {% set input_match = input_token_data | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n    {% set output_match = output_token_data | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n    {% set tool_count_match = tool_count | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n    {% set msg_match = llm_output | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n\r\n    {% set input = input_match[0].token_usage_input_tokens_sum if input_match else 0 %}\r\n    {% set output = output_match[0].token_usage_output_tokens_sum if output_match else 0 %}\r\n    {% set tools = tool_count_match[0].count__sum if tool_count_match else 0 %}\r\n    {% set message_raw = msg_match[0].message if msg_match else '' %}\r\n    {% set clean_message = message_raw | replace('\\n', ' ') | trim %}\r\n    {% set total = input + output %}\r\n\r\n    {% set input_cost = (input / 1_000_000) * (costs[llm][0] if llm in costs else 0) %}\r\n    {% set output_cost = (output / 1_000_000) * (costs[llm][1] if llm in costs else 0) %}\r\n    {% set total_cost = input_cost + output_cost %}\r\n\r\n    {# Duration #}\r\n    {% set min_time = row.timestamp_min %}\r\n    {% set max_time = row.timestamp_max %}\r\n    {% set duration_seconds = (max_time - min_time) / 1000 %}\r\n    {% set hours = (duration_seconds // 3600) | int %}\r\n    {% set minutes = ((duration_seconds % 3600) // 60) | int %}\r\n    {% set seconds = (duration_seconds % 60) | int %}\r\n\r\n    {% set parts = [] %}\r\n    {% if hours > 0 %}{% set _ = parts.append(hours ~ \"h\") %}{% endif %}\r\n    {% if minutes > 0 %}{% set _ = parts.append(minutes ~ \"m\") %}{% endif %}\r\n    {% if seconds > 0 %}{% set _ = parts.append(seconds ~ \"s\") %}{% endif %}\r\n    {% if parts|length == 0 %}{% set _ = parts.append(\"0s\") %}{% endif %}\r\n    {% set duration_str = parts | join(\" \") %}\r\n\r\n    {# Safe fallback: show epoch timestamps #}\r\n    {% set min_iso = min_time %}\r\n    {% set max_iso = max_time %}\r\n\r\n    {% set updated_row = {\r\n        \"llm\": llm,\r\n        \"token_usage_input_tokens\": input | int,\r\n        \"token_usage_output_tokens\": output | int,\r\n        \"token_usage_total_tokens\": total | int,\r\n        \"tool_count\": tools | int,\r\n        \"output\": clean_message,\r\n        \"input_cost\": input_cost | round(4),\r\n        \"output_cost\": output_cost | round(4),\r\n        \"total_cost\": total_cost | round(4),\r\n        \"duration\": duration_str,\r\n        \"start_time_iso\": min_iso,\r\n        \"end_time_iso\": max_iso\r\n    } %}\r\n    {% set _ = merged_data.append(updated_row) %}\r\n{% endfor %}\r\n\r\n<h2 style=\"color: white; font-size: 24px; text-align: center;\">LLM Output Summary</h2>\r\n<div style=\"width: 100%; overflow-x: auto; padding: 30px 40px; box-sizing: border-box;\">\r\n    <div style=\"display: flex; flex-direction: row; gap: 30px; flex-wrap: nowrap; align-items: flex-start; min-width: max-content;\">\r\n        {% for data in merged_data %}\r\n        <div style=\"min-width: 450px; max-width: 550px; height: calc(100vh - 150px); background: #1c1e22; border-radius: 14px; color: white; font-family: sans-serif; box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4); display: flex; flex-direction: column; padding: 20px; flex-shrink: 0;\">\r\n            \r\n            <div style=\"flex: 0 0 auto;\">\r\n                <p style=\"font-size: 22px; font-weight: bold; text-align: center; margin-bottom: 12px;\">{{ data.llm or \"Model\" }}</p>\r\n\r\n                <div style=\"display: flex; justify-content: space-between; gap: 10px; margin-top: 8px;\">\r\n                    <div style=\"flex: 1;\">\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Input Tokens:</strong> {{ \"{:,}\".format(data.token_usage_input_tokens) }}</p>\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Output Tokens:</strong> {{ \"{:,}\".format(data.token_usage_output_tokens) }}</p>\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Total Tokens:</strong> {{ \"{:,}\".format(data.token_usage_total_tokens) }}</p>\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Tools:</strong> {{ \"{:,}\".format(data.tool_count) }}</p>\r\n                    </div>\r\n\r\n                    <div style=\"border-left: 1px solid #555; padding-left: 10px; flex: 1;\">\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Input Cost:</strong> ${{ data.input_cost }}</p>\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Output Cost:</strong> ${{ data.output_cost }}</p>\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Total Cost:</strong> ${{ data.total_cost }}</p>\r\n                        <p style=\"margin: 4px 0; font-size: 14px;\"><strong>Duration:</strong> {{ data.duration }}</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <hr style=\"margin: 15px 0; border: none; border-top: 1px solid #444;\">\r\n            \r\n            <div style=\"flex-grow: 1; overflow-y: auto; background: #2a2d33; border-radius: 10px; padding: 12px; font-size: 13px; white-space: pre-wrap; border: 1px solid #444; box-shadow: inset 0 2px 4px rgba(0,0,0,0.4);\">\r\n                {{ data.output or \"No output found\" }}\r\n            </div>\r\n        </div>\r\n        {% endfor %}\r\n    </div>\r\n</div>"
        },
        {
            "name": "output_ah_new",
            "value": "{% set cfxql_pass_query = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty\" %}\r\n{% set cfxql_pass_query_tool_count = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty and tool_name is not empty\" %}\r\n{% set cfxql_pass_query_output = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty and type == 'Assistant' and tool_content is empty and tool_name is empty\" %}\r\n{% set cfxql_pass_query_prompt = \"parentConversationId is '\" ~ context.conversationId ~\"' and type == 'client'\" %}\r\n{% set cfxql_pass_query_persona = \"parentConversationId is '\" ~ context.conversationId ~\"' and isModelComparison is not empty\" %}\r\n{% set cfxql_pass_query_summary = \"parentConversationId is '\" ~ context.conversationId ~\"' and isModelComparison is true and request_type is 'API' and request_subtype_0 is 'generate-llm-response'\" %}\r\n{# Get prompt and persona data #}\r\n{% set prompt_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query_prompt,\r\n    aggs=[{\"field\": \"message\", \"func\": \"value_count\"}],\r\n    groupby=[\"message\"]\r\n) %}\r\n{% set persona_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query_persona,\r\n    aggs=[{\"field\": \"persona\", \"func\": \"value_count\"}],\r\n    groupby=[\"persona\", \"ai_project_name\"]\r\n) %}\r\n{# Aggregate queries #}\r\n{% set all_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query,\r\n    aggs=[\r\n        {\"field\": \"conversationId\", \"func\": \"value_count\"},\r\n        {\"field\": \"timestamp\", \"func\": \"min\"},\r\n        {\"field\": \"timestamp\", \"func\": \"max\"}\r\n    ],\r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set input_token_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query,\r\n    aggs=[{\"field\": \"token_usage_input_tokens\", \"func\": \"sum\"}],\r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set output_token_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query,\r\n    aggs=[{\"field\": \"token_usage_output_tokens\", \"func\": \"sum\"}],\r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set tool_count = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query_tool_count,\r\n    aggs=[{\"field\": \"count_\", \"func\": \"sum\"}],\r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set llm_output = engine.query_stream_data(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query_output,\r\n    limit=100\r\n) %}\r\n\r\n{% set summary_output = engine.query_stream_data(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query_summary,\r\n    limit=100\r\n) %}\r\n\r\n{% set llm_cost_query = ' * GET llm_name, input_token_cost_per1M, output_token_cost_per1M' %}\r\n{% set llm_costs = engine.query_stream_data(\r\n    \"llm_model_costs\",\r\n    cfxql_query=llm_cost_query,\r\n    sorting=[{\"llm_name\": \"asc\"}],\r\n    limit=100,\r\n    max_rows=100\r\n) %}\r\n{% set costs = {} %}\r\n{% for cost_row in llm_costs %}\r\n    {% set _ = costs.update({\r\n        cost_row.llm_name: [\r\n            cost_row.input_token_cost_per1M | float, \r\n            cost_row.output_token_cost_per1M | float\r\n        ]\r\n    }) %}\r\n{% endfor %}\r\n{# Calculate star ratings for models #}\r\n{% set expected_tool_calls = 10 %}\r\n{% set output_list = llm_output | map(attribute='message') | list %}\r\n{% set all_tokens = [] %}\r\n{% for message in output_list %}\r\n  {% for word in message.split() %}\r\n    {% set word_clean = word | lower %}\r\n    {% if word_clean not in all_tokens %}\r\n      {% set _ = all_tokens.append(word_clean) %}\r\n    {% endif %}\r\n  {% endfor %}\r\n{% endfor %}\r\n\r\n{% set merged_data = [] %}\r\n{% for row in all_data %}\r\n    {% set llm = row.llm %}\r\n    {% set input_match = input_token_data | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n    {% set output_match = output_token_data | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n    {% set tool_count_match = tool_count | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n    {% set msg_match = llm_output | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n    {% set input = input_match[0].token_usage_input_tokens_sum if input_match else 0 %}\r\n    {% set output = output_match[0].token_usage_output_tokens_sum if output_match else 0 %}\r\n    {% set tools = tool_count_match[0].count__sum if tool_count_match else 0 %}\r\n    {% set message_raw = msg_match[0].message if msg_match else '' %}\r\n    {% set clean_message = message_raw | replace('\\n', ' ') | trim %}\r\n    {% set total = input + output %}\r\n    {% set input_cost = (input / 1_000_000) * (costs[llm][0] if llm in costs else 0) %}\r\n    {% set output_cost = (output / 1_000_000) * (costs[llm][1] if llm in costs else 0) %}\r\n    {% set total_cost = input_cost + output_cost %}\r\n    \r\n    {# Calculate star rating #}\r\n    {% set tokenized = [] %}\r\n    {% for w in clean_message.split() %}\r\n      {% set wclean = w | lower %}\r\n      {% if wclean not in tokenized %}{% set _ = tokenized.append(wclean) %}{% endif %}\r\n    {% endfor %}\r\n    {% set match_count = 0 %}\r\n    {% for word in all_tokens %}\r\n      {% if word in tokenized %}{% set match_count = match_count + 1 %}{% endif %}\r\n    {% endfor %}\r\n    {% set union_count = (tokenized | length) + (all_tokens | length) - match_count %}\r\n    {% set domain_coverage_score = (match_count / union_count) if union_count > 0 else 0 %}\r\n    {% set output_ratio = (output / total) if total > 0 else 0 %}\r\n    {% set tool_score = 1 - ((tools - expected_tool_calls) | abs / expected_tool_calls) %}\r\n    {% set tool_score = tool_score if tool_score >= 0 else 0 %}\r\n    {% set cost_score = (1 / (1 + total_cost)) %}\r\n    {% set score = (domain_coverage_score * 0.4 + (output_ratio * 0.2 + tool_score * 0.2 + cost_score * 0.2)) | round(4) %}\r\n    \r\n    {# Duration #}\r\n    {% set min_time = row.timestamp_min %}\r\n    {% set max_time = row.timestamp_max %}\r\n    {% set duration_seconds = (max_time - min_time) / 1000 %}\r\n    {% set hours = (duration_seconds // 3600) | int %}\r\n    {% set minutes = ((duration_seconds % 3600) // 60) | int %}\r\n    {% set seconds = (duration_seconds % 60) | int %}\r\n    {% set parts = [] %}\r\n    {% if hours > 0 %}{% set _ = parts.append(hours ~ \"h\") %}{% endif %}\r\n    {% if minutes > 0 %}{% set _ = parts.append(minutes ~ \"m\") %}{% endif %}\r\n    {% if seconds > 0 %}{% set _ = parts.append(seconds ~ \"s\") %}{% endif %}\r\n    {% if parts|length == 0 %}{% set _ = parts.append(\"0s\") %}{% endif %}\r\n    {% set duration_str = parts | join(\" \") %}\r\n    {# Calculate metrics for summary #}\r\n    {% set complexity_score = 1.0 %}\r\n    {% set updated_row = {\r\n        \"llm\": llm,\r\n        \"token_usage_input_tokens\": input | int,\r\n        \"token_usage_output_tokens\": output | int,\r\n        \"token_usage_total_tokens\": total | int,\r\n        \"tool_count\": tools | int,\r\n        \"output\": clean_message,\r\n        \"input_cost\": input_cost | round(4),\r\n        \"output_cost\": output_cost | round(4),\r\n        \"total_cost\": total_cost | round(4),\r\n        \"duration\": duration_str,\r\n        \"start_time_iso\": min_time,\r\n        \"end_time_iso\": max_time,\r\n        \"complexity_score\": complexity_score,\r\n        \"latency\": duration_seconds,\r\n        \"score\": score\r\n    } %}\r\n    {% set _ = merged_data.append(updated_row) %}\r\n{% endfor %}\r\n\r\n{# Normalize scores to 1\u20135 stars #}\r\n{% set score_values = merged_data | map(attribute=\"score\") | list %}\r\n{% set min_score = score_values | min %}\r\n{% set max_score = score_values | max %}\r\n{% for row in merged_data %}\r\n  {% set norm_score = ((row.score - min_score) / (max_score - min_score + 0.0001)) %}\r\n  {% set star_rating = (norm_score * 4 + 1) | round(2) %}\r\n  {% set _ = row.update({\"star_rating\": star_rating}) %}\r\n{% endfor %}\r\n{% set best_star_model = merged_data | max(attribute=\"star_rating\") %}\r\n{# Get prompt and persona text #}\r\n{% set prompt_text = prompt_data[0].message if prompt_data else \"No prompt found\" %}\r\n{% if persona_data and persona_data[0].ai_project_name and persona_data[0].persona %}\r\n    {% set persona_text = persona_data[0].ai_project_name ~ \"/\" ~ persona_data[0].persona %}\r\n{% elif persona_data and persona_data[0].persona %}\r\n    {% set persona_text = persona_data[0].persona %}\r\n{% else %}\r\n    {% set persona_text = \"No persona found\" %}\r\n{% endif %}\r\n{# Generate comparison summary #}\r\n{% set total_models = merged_data | list | length %}\r\n{% set best_model = merged_data | sort(attribute='word_count', reverse=true) | first %}\r\n{% set worst_model = merged_data | sort(attribute='word_count') | first %}\r\n<div style=\"background: #0a0a0a; color: white; font-family: 'Segoe UI', sans-serif; padding: 20px; min-height: 100vh; max-width: 1600px; margin: 0 auto;\">\r\n    \r\n    <!-- Prompt Details Section -->\r\n    <div style=\"background: #1a1a1a; border-radius: 8px; padding: 20px; margin-bottom: 20px; border: 1px solid #333;\">\r\n        <h2 style=\"color: #4a9eff; font-size: 18px; margin-bottom: 15px; font-weight: bold;\">Prompt Details</h2>\r\n        <div style=\"margin-bottom: 15px;\">\r\n            <p style=\"margin: 8px 0; font-size: 14px; color: #cccccc;\"><strong>Persona Name:</strong> <span style=\"color: #ffffff;\">{{ persona_text }}</span></p>\r\n            <p style=\"margin: 8px 0; font-size: 14px; color: #cccccc;\"><strong>Original Prompt:</strong> <span style=\"color: #ffffff;\">{{ prompt_text }}</span></p>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- Detailed Summary Section -->\r\n    <div style=\"background: #1a1a1a; border-radius: 8px; padding: 20px; margin-bottom: 20px; border: 1px solid #333;\">\r\n        <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;\">\r\n            <h2 style=\"color: #4a9eff; font-size: 18px; margin: 0; font-weight: bold;\">Model Comparison Summary</h2>\r\n            \r\n        </div>\r\n        <div class=\"summary-scroll-container\" style=\"background: #2a2a2a; padding: 20px; border-radius: 6px; border: 1px solid #444; max-height: 400px; overflow-y: auto;\">\r\n            {% set valid_summaries = [] %}\r\n            {% if summary_output and summary_output | length > 0 %}\r\n                {% for summary_item in summary_output %}\r\n                    {% if summary_item.message and summary_item.message | trim %}\r\n                        {% set _ = valid_summaries.append(summary_item) %}\r\n                    {% endif %}\r\n                {% endfor %}\r\n            {% endif %}\r\n            \r\n            {% if valid_summaries | length > 0 %}\r\n                {% for summary_item in valid_summaries %}\r\n                    {% set clean_message = summary_item.message | trim %}\r\n                    {# Remove \"html\" prefix if present #}\r\n                    {% if clean_message.lower().startswith('html') %}\r\n                        {% set clean_message = clean_message[4:] | trim %}\r\n                    {% endif %}\r\n                    {# Extract content between <body> tags if present #}\r\n                    {% if '<body>' in clean_message %}\r\n                        {% set body_start = clean_message.find('<body>') + 6 %}\r\n                        {% set body_end = clean_message.find('</body>') %}\r\n                        {% if body_end > body_start %}\r\n                            {% set clean_message = clean_message[body_start:body_end] | trim %}\r\n                        {% endif %}\r\n                    {% endif %}\r\n                    <div style=\"margin-bottom: 20px;\">\r\n                        {{ clean_message | safe }}\r\n                    </div>\r\n                {% endfor %}\r\n            {% else %}\r\n                <div style=\"text-align: center; padding: 40px 20px;\">\r\n                    <p style=\"font-size: 16px; color: #cccccc; margin: 0;\">\r\n                        <strong>No summary generated yet.</strong>\r\n                    </p>\r\n                    <p style=\"font-size: 14px; color: #888888; margin-top: 10px;\">\r\n                        The AI-generated comparison summary will appear here once available.\r\n                    </p>\r\n                </div>\r\n            {% endif %}\r\n        </div>\r\n    </div>\r\n\r\n    <!-- Metrics Comparison Section -->\r\n    <div style=\"background: #1a1a1a; border-radius: 8px; padding: 20px; border: 1px solid #333;\">\r\n        <h2 style=\"color: #4a9eff; font-size: 18px; margin-bottom: 15px; font-weight: bold;\">Metrics Comparison{% if merged_data | length > 3 %} <span style=\"font-size: 12px; color: #cccccc; font-weight: normal;\">(Scroll to view all models)</span>{% endif %}</h2>\r\n        {% set num_models = merged_data | length %}\r\n        {% set table_height = 400 if num_models > 3 else 600 %}\r\n        {% set table_min_width = 1000 + (num_models - 3) * 200 if num_models > 3 else 1000 %}\r\n        <div style=\"overflow-x: auto; width: 100%; border: 1px solid #444; border-radius: 8px; max-height: {{ table_height }}px; overflow-y: auto;\">\r\n            <table style=\"width: 100%; min-width: {{ table_min_width }}px; border-collapse: collapse; background: #2a2a2a; border-radius: 8px;\">\r\n                <thead>\r\n                    <tr style=\"background: #333;\">\r\n                        <th style=\"padding: 12px 8px; text-align: left; border-bottom: 1px solid #444; color: #4a9eff; font-weight: bold; min-width: 160px; font-size: 13px; position: sticky; left: 0; background: #333; z-index: 10;\">Metric</th>\r\n                        {% for data in merged_data %}\r\n                        <th style=\"padding: 12px 8px; text-align: center; border-bottom: 1px solid #444; color: #4a9eff; font-weight: bold; min-width: 150px; white-space: nowrap; font-size: 12px; background: #333;\">\r\n                            {{ data.llm }}\r\n                        </th>\r\n                        {% endfor %}\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n\r\n                    <tr>\r\n                        <td style=\"padding: 10px 8px; border-bottom: 1px solid #444; color: #ffffff; font-weight: bold; background: #2a2a2a; font-size: 12px; position: sticky; left: 0; z-index: 5;\" title=\"Number of tokens used from the input prompt\">Input Tokens</td>\r\n                        {% for data in merged_data %}\r\n                        <td style=\"padding: 10px 8px; text-align: center; border-bottom: 1px solid #444; color: #ffffff; background: #2a2a2a; font-size: 11px;\">{{ \"{:,}\".format(data.token_usage_input_tokens) }}</td>\r\n                        {% endfor %}\r\n                    </tr>\r\n                    <tr>\r\n                        <td style=\"padding: 10px 8px; border-bottom: 1px solid #444; color: #ffffff; font-weight: bold; background: #2a2a2a; font-size: 12px; position: sticky; left: 0; z-index: 5;\" title=\"Time taken to generate the response (in seconds)\">Latency</td>\r\n                        {% for data in merged_data %}\r\n                        <td style=\"padding: 10px 8px; text-align: center; border-bottom: 1px solid #444; color: #ffffff; background: #2a2a2a; font-size: 11px;\">{{ \"%.2f\" | format(data.latency) }}s</td>\r\n                        {% endfor %}\r\n                    </tr>\r\n                    <tr>\r\n                        <td style=\"padding: 10px 8px; border-bottom: 1px solid #444; color: #ffffff; font-weight: bold; background: #2a2a2a; font-size: 12px; position: sticky; left: 0; z-index: 5;\" title=\"Number of tokens generated in the response\">Output Tokens</td>\r\n                        {% for data in merged_data %}\r\n                        <td style=\"padding: 10px 8px; text-align: center; border-bottom: 1px solid #444; color: #ffffff; background: #2a2a2a; font-size: 11px;\">{{ \"{:,}\".format(data.token_usage_output_tokens) }}</td>\r\n                        {% endfor %}\r\n                    </tr>\r\n                    <tr>\r\n                        <td style=\"padding: 10px 8px; border-bottom: 1px solid #444; color: #ffffff; font-weight: bold; background: #2a2a2a; font-size: 12px; position: sticky; left: 0; z-index: 5;\" title=\"Total tokens used (input + output)\">Total Tokens</td>\r\n                        {% for data in merged_data %}\r\n                        <td style=\"padding: 10px 8px; text-align: center; border-bottom: 1px solid #444; color: #ffffff; background: #2a2a2a; font-size: 11px;\">{{ \"{:,}\".format(data.token_usage_total_tokens) }}</td>\r\n                        {% endfor %}\r\n                    </tr>\r\n                    <tr>\r\n                        <td style=\"padding: 10px 8px; border-bottom: 1px solid #444; color: #ffffff; font-weight: bold; background: #2a2a2a; font-size: 12px; position: sticky; left: 0; z-index: 5;\">Pricing</td>\r\n                        {% for data in merged_data %}\r\n                        <td style=\"padding: 10px 8px; text-align: center; border-bottom: 1px solid #444; color: #ffffff; background: #2a2a2a; font-size: 10px;\">${{ costs[data.llm][0] if data.llm in costs else 0 }} per 1M input;<br>${{ costs[data.llm][1] if data.llm in costs else 0 }} per 1M output</td>\r\n                        {% endfor %}\r\n                    </tr>\r\n                    <tr>\r\n                        <td style=\"padding: 10px 8px; border-bottom: 1px solid #444; color: #ffffff; font-weight: bold; background: #2a2a2a; font-size: 12px; position: sticky; left: 0; z-index: 5;\" title=\"Cost for input tokens only\">Input Cost</td>\r\n                        {% for data in merged_data %}\r\n                        <td style=\"padding: 10px 8px; text-align: center; border-bottom: 1px solid #444; color: #ffffff; background: #2a2a2a; font-size: 11px;\">${{ \"%.4f\" | format(data.input_cost) }}</td>\r\n                        {% endfor %}\r\n                    </tr>\r\n                    <tr>\r\n                        <td style=\"padding: 10px 8px; border-bottom: 1px solid #444; color: #ffffff; font-weight: bold; background: #2a2a2a; font-size: 12px; position: sticky; left: 0; z-index: 5;\" title=\"Cost for output tokens only\">Output Cost</td>\r\n                        {% for data in merged_data %}\r\n                        <td style=\"padding: 10px 8px; text-align: center; border-bottom: 1px solid #444; color: #ffffff; background: #2a2a2a; font-size: 11px;\">${{ \"%.4f\" | format(data.output_cost) }}</td>\r\n                        {% endfor %}\r\n                    </tr>\r\n                    <tr>\r\n                        <td style=\"padding: 10px 8px; border-bottom: 1px solid #444; color: #ffffff; font-weight: bold; background: #2a2a2a; font-size: 12px; position: sticky; left: 0; z-index: 5;\" title=\"Total cost for this model's response (input + output tokens)\">Total Cost</td>\r\n                        {% for data in merged_data %}\r\n                        <td style=\"padding: 10px 8px; text-align: center; border-bottom: 1px solid #444; color: #ffffff; background: #2a2a2a; font-size: 11px;\">${{ \"%.4f\" | format(data.total_cost) }}</td>\r\n                        {% endfor %}\r\n                    </tr>\r\n                    <tr>\r\n                        <td style=\"padding: 10px 8px; border-bottom: 1px solid #444; color: #ffffff; font-weight: bold; background: #2a2a2a; font-size: 12px; position: sticky; left: 0; z-index: 5;\" title=\"Number of tools called during the response generation\">Tools Called</td>\r\n                        {% for data in merged_data %}\r\n                        <td style=\"padding: 10px 8px; text-align: center; border-bottom: 1px solid #444; color: #ffffff; background: #2a2a2a; font-size: 11px;\">{{ data.tool_count }}</td>\r\n                        {% endfor %}\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n\r\n<style>\r\n/* Simple scrollbar styling */\r\n::-webkit-scrollbar {\r\n    height: 8px;\r\n    width: 8px;\r\n}\r\n\r\n::-webkit-scrollbar-track {\r\n    background: #1a1a1a;\r\n    border-radius: 4px;\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n    background: #444;\r\n    border-radius: 4px;\r\n}\r\n\r\n::-webkit-scrollbar-thumb:hover {\r\n    background: #666;\r\n}\r\n\r\n/* Center the container */\r\nbody {\r\n    background: #000000;\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\n/* Download link styling */\r\na[href*=\"File%20Browser\"]:hover {\r\n    background: #3a8eef !important;\r\n    transform: translateY(-2px);\r\n    box-shadow: 0 4px 8px rgba(0,0,0,0.3);\r\n}\r\n\r\na[href*=\"File%20Browser\"]:active {\r\n    transform: translateY(0);\r\n    box-shadow: 0 2px 4px rgba(0,0,0,0.2);\r\n}\r\n\r\n/* Custom scrollbar for summary container */\r\n.summary-scroll-container::-webkit-scrollbar {\r\n    width: 8px;\r\n}\r\n\r\n.summary-scroll-container::-webkit-scrollbar-track {\r\n    background: #1a1a1a;\r\n    border-radius: 4px;\r\n}\r\n\r\n.summary-scroll-container::-webkit-scrollbar-thumb {\r\n    background: #4a9eff;\r\n    border-radius: 4px;\r\n    box-shadow: 0 0 5px rgba(74, 158, 255, 0.3);\r\n}\r\n\r\n.summary-scroll-container::-webkit-scrollbar-thumb:hover {\r\n    background: #3a8eef;\r\n    box-shadow: 0 0 8px rgba(74, 158, 255, 0.5);\r\n}\r\n\r\n/* Custom scrollbar for individual model analysis */\r\n.individual-analysis-scroll::-webkit-scrollbar {\r\n    width: 6px;\r\n}\r\n\r\n.individual-analysis-scroll::-webkit-scrollbar-track {\r\n    background: #2a2a2a;\r\n    border-radius: 3px;\r\n}\r\n\r\n.individual-analysis-scroll::-webkit-scrollbar-thumb {\r\n    background: #555;\r\n    border-radius: 3px;\r\n}\r\n \r\n.individual-analysis-scroll::-webkit-scrollbar-thumb:hover {\r\n    background: #777;\r\n}\r\n</style>"
        },
        {
            "name": "output_ah_new.jinja",
            "value": "{% set cfxql_pass_query = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty\" %}\r\n{% set cfxql_pass_query_tool_count = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty and tool_name is not empty\" %}\r\n{% set cfxql_pass_query_output = \"parentConversationId is '\" ~ context.conversationId ~\"' and llm is not empty and type == 'Assistant' and tool_content is empty and tool_name is empty\" %}\r\n{% set cfxql_pass_query_prompt = \"parentConversationId is '\" ~ context.conversationId ~\"' and type == 'client'\" %}\r\n{% set cfxql_pass_query_persona = \"parentConversationId is '\" ~ context.conversationId ~\"' and isModelComparison is not empty\" %}\r\n{% set cfxql_pass_query_summary = \"parentConversationId is '\" ~ context.conversationId ~\"' and isModelComparison is true and request_type is 'API' and request_subtype_0 is 'generate-llm-response'\" %}\r\n{# Get prompt and persona data #}\r\n{% set prompt_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query_prompt,\r\n    aggs=[{\"field\": \"message\", \"func\": \"value_count\"}],\r\n    groupby=[\"message\"]\r\n) %}\r\n{% set persona_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query_persona,\r\n    aggs=[{\"field\": \"persona\", \"func\": \"value_count\"}],\r\n    groupby=[\"persona\", \"ai_project_name\"]\r\n) %}\r\n{# Aggregate queries #}\r\n{% set all_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query,\r\n    aggs=[\r\n        {\"field\": \"conversationId\", \"func\": \"value_count\"},\r\n        {\"field\": \"timestamp\", \"func\": \"min\"},\r\n        {\"field\": \"timestamp\", \"func\": \"max\"}\r\n    ],\r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set input_token_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query,\r\n    aggs=[{\"field\": \"token_usage_input_tokens\", \"func\": \"sum\"}],\r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set output_token_data = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query,\r\n    aggs=[{\"field\": \"token_usage_output_tokens\", \"func\": \"sum\"}],\r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set tool_count = engine.query_stream_aggs(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query_tool_count,\r\n    aggs=[{\"field\": \"count_\", \"func\": \"sum\"}],\r\n    groupby=[\"llm\"]\r\n) %}\r\n{% set llm_output = engine.query_stream_data(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query_output,\r\n    limit=100\r\n) %}\r\n\r\n{% set summary_output = engine.query_stream_data(\r\n    stream=\"rda_chat_sessions\",\r\n    cfxql_query=cfxql_pass_query_summary,\r\n    limit=100\r\n) %}\r\n\r\n{% set llm_cost_query = ' * GET llm_name, input_token_cost_per1M, output_token_cost_per1M' %}\r\n{% set llm_costs = engine.query_stream_data(\r\n    \"llm_model_costs\",\r\n    cfxql_query=llm_cost_query,\r\n    sorting=[{\"llm_name\": \"asc\"}],\r\n    limit=100,\r\n    max_rows=100\r\n) %}\r\n{% set costs = {} %}\r\n{% for cost_row in llm_costs %}\r\n    {% set _ = costs.update({\r\n        cost_row.llm_name: [\r\n            cost_row.input_token_cost_per1M | float, \r\n            cost_row.output_token_cost_per1M | float\r\n        ]\r\n    }) %}\r\n{% endfor %}\r\n{# Calculate star ratings for models #}\r\n{% set expected_tool_calls = 10 %}\r\n{% set output_list = llm_output | map(attribute='message') | list %}\r\n{% set all_tokens = [] %}\r\n{% for message in output_list %}\r\n  {% for word in message.split() %}\r\n    {% set word_clean = word | lower %}\r\n    {% if word_clean not in all_tokens %}\r\n      {% set _ = all_tokens.append(word_clean) %}\r\n    {% endif %}\r\n  {% endfor %}\r\n{% endfor %}\r\n\r\n{% set merged_data = [] %}\r\n{% for row in all_data %}\r\n    {% set llm = row.llm %}\r\n    {% set input_match = input_token_data | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n    {% set output_match = output_token_data | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n    {% set tool_count_match = tool_count | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n    {% set msg_match = llm_output | selectattr(\"llm\", \"equalto\", llm) | list %}\r\n    {% set input = input_match[0].token_usage_input_tokens_sum if input_match else 0 %}\r\n    {% set output = output_match[0].token_usage_output_tokens_sum if output_match else 0 %}\r\n    {% set tools = tool_count_match[0].count__sum if tool_count_match else 0 %}\r\n    {% set message_raw = msg_match[0].message if msg_match else '' %}\r\n    {% set clean_message = message_raw | replace('\\n', ' ') | trim %}\r\n    {% set total = input + output %}\r\n    {% set input_cost = (input / 1_000_000) * (costs[llm][0] if llm in costs else 0) %}\r\n    {% set output_cost = (output / 1_000_000) * (costs[llm][1] if llm in costs else 0) %}\r\n    {% set total_cost = input_cost + output_cost %}\r\n    \r\n    {# Calculate star rating #}\r\n    {% set tokenized = [] %}\r\n    {% for w in clean_message.split() %}\r\n      {% set wclean = w | lower %}\r\n      {% if wclean not in tokenized %}{% set _ = tokenized.append(wclean) %}{% endif %}\r\n    {% endfor %}\r\n    {% set match_count = 0 %}\r\n    {% for word in all_tokens %}\r\n      {% if word in tokenized %}{% set match_count = match_count + 1 %}{% endif %}\r\n    {% endfor %}\r\n    {% set union_count = (tokenized | length) + (all_tokens | length) - match_count %}\r\n    {% set domain_coverage_score = (match_count / union_count) if union_count > 0 else 0 %}\r\n    {% set output_ratio = (output / total) if total > 0 else 0 %}\r\n    {% set tool_score = 1 - ((tools - expected_tool_calls) | abs / expected_tool_calls) %}\r\n    {% set tool_score = tool_score if tool_score >= 0 else 0 %}\r\n    {% set cost_score = (1 / (1 + total_cost)) %}\r\n    {% set score = (domain_coverage_score * 0.4 + (output_ratio * 0.2 + tool_score * 0.2 + cost_score * 0.2)) | round(4) %}\r\n    \r\n    {# Duration #}\r\n    {% set min_time = row.timestamp_min %}\r\n    {% set max_time = row.timestamp_max %}\r\n    {% set duration_seconds = (max_time - min_time) / 1000 %}\r\n    {% set hours = (duration_seconds // 3600) | int %}\r\n    {% set minutes = ((duration_seconds % 3600) // 60) | int %}\r\n    {% set seconds = (duration_seconds % 60) | int %}\r\n    {% set parts = [] %}\r\n    {% if hours > 0 %}{% set _ = parts.append(hours ~ \"h\") %}{% endif %}\r\n    {% if minutes > 0 %}{% set _ = parts.append(minutes ~ \"m\") %}{% endif %}\r\n    {% if seconds > 0 %}{% set _ = parts.append(seconds ~ \"s\") %}{% endif %}\r\n    {% if parts|length == 0 %}{% set _ = parts.append(\"0s\") %}{% endif %}\r\n    {% set duration_str = parts | join(\" \") %}\r\n    {# Calculate metrics for summary #}\r\n    {% set complexity_score = 1.0 %}\r\n    {% set updated_row = {\r\n        \"llm\": llm,\r\n        \"token_usage_input_tokens\": input | int,\r\n        \"token_usage_output_tokens\": output | int,\r\n        \"token_usage_total_tokens\": total | int,\r\n        \"tool_count\": tools | int,\r\n        \"output\": clean_message,\r\n        \"input_cost\": input_cost | round(4),\r\n        \"output_cost\": output_cost | round(4),\r\n        \"total_cost\": total_cost | round(4),\r\n        \"duration\": duration_str,\r\n        \"start_time_iso\": min_time,\r\n        \"end_time_iso\": max_time,\r\n        \"complexity_score\": complexity_score,\r\n        \"latency\": duration_seconds,\r\n        \"score\": score\r\n    } %}\r\n    {% set _ = merged_data.append(updated_row) %}\r\n{% endfor %}\r\n\r\n{# Normalize scores to 1\u20135 stars #}\r\n{% set score_values = merged_data | map(attribute=\"score\") | list %}\r\n{% set min_score = score_values | min %}\r\n{% set max_score = score_values | max %}\r\n{% for row in merged_data %}\r\n  {% set norm_score = ((row.score - min_score) / (max_score - min_score + 0.0001)) %}\r\n  {% set star_rating = (norm_score * 4 + 1) | round(2) %}\r\n  {% set _ = row.update({\"star_rating\": star_rating}) %}\r\n{% endfor %}\r\n{% set best_star_model = merged_data | max(attribute=\"star_rating\") %}\r\n{# Get prompt and persona text #}\r\n{% set prompt_text = prompt_data[0].message if prompt_data else \"No prompt found\" %}\r\n{% if persona_data and persona_data[0].ai_project_name and persona_data[0].persona %}\r\n    {% set persona_text = persona_data[0].ai_project_name ~ \"/\" ~ persona_data[0].persona %}\r\n{% elif persona_data and persona_data[0].persona %}\r\n    {% set persona_text = persona_data[0].persona %}\r\n{% else %}\r\n    {% set persona_text = \"No persona found\" %}\r\n{% endif %}\r\n{# Generate comparison summary #}\r\n{% set total_models = merged_data | list | length %}\r\n{% set best_model = merged_data | sort(attribute='word_count', reverse=true) | first %}\r\n{% set worst_model = merged_data | sort(attribute='word_count') | first %}\r\n<div style=\"background: #0a0a0a; color: white; font-family: 'Segoe UI', sans-serif; padding: 20px; min-height: 100vh; max-width: 1600px; margin: 0 auto;\">\r\n    \r\n    <!-- Prompt Details Section -->\r\n    <div style=\"background: #1a1a1a; border-radius: 8px; padding: 20px; margin-bottom: 20px; border: 1px solid #333;\">\r\n        <h2 style=\"color: #4a9eff; font-size: 18px; margin-bottom: 15px; font-weight: bold;\">Prompt Details</h2>\r\n        <div style=\"margin-bottom: 15px;\">\r\n            <p style=\"margin: 8px 0; font-size: 14px; color: #cccccc;\"><strong>Persona Name:</strong> <span style=\"color: #ffffff;\">{{ persona_text }}</span></p>\r\n            <p style=\"margin: 8px 0; font-size: 14px; color: #cccccc;\"><strong>Original Prompt:</strong> <span style=\"color: #ffffff;\">{{ prompt_text }}</span></p>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- Detailed Summary Section -->\r\n    <div style=\"background: #1a1a1a; border-radius: 8px; padding: 20px; margin-bottom: 20px; border: 1px solid #333;\">\r\n        <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;\">\r\n            <h2 style=\"color: #4a9eff; font-size: 18px; margin: 0; font-weight: bold;\">Model Comparison Summary</h2>\r\n            \r\n        </div>\r\n        <div class=\"summary-scroll-container\" style=\"background: #2a2a2a; padding: 20px; border-radius: 6px; border: 1px solid #444; max-height: 400px; overflow-y: auto;\">\r\n            {% set valid_summaries = [] %}\r\n            {% if summary_output and summary_output | length > 0 %}\r\n                {% for summary_item in summary_output %}\r\n                    {% if summary_item.message and summary_item.message | trim %}\r\n                        {% set _ = valid_summaries.append(summary_item) %}\r\n                    {% endif %}\r\n                {% endfor %}\r\n            {% endif %}\r\n            \r\n            {% if valid_summaries | length > 0 %}\r\n                {% for summary_item in valid_summaries %}\r\n                    {% set clean_message = summary_item.message | trim %}\r\n                    {# Remove \"html\" prefix if present #}\r\n                    {% if clean_message.lower().startswith('html') %}\r\n                        {% set clean_message = clean_message[4:] | trim %}\r\n                    {% endif %}\r\n                    {# Extract content between <body> tags if present #}\r\n                    {% if '<body>' in clean_message %}\r\n                        {% set body_start = clean_message.find('<body>') + 6 %}\r\n                        {% set body_end = clean_message.find('</body>') %}\r\n                        {% if body_end > body_start %}\r\n                            {% set clean_message = clean_message[body_start:body_end] | trim %}\r\n                        {% endif %}\r\n                    {% endif %}\r\n                    <div style=\"margin-bottom: 20px;\">\r\n                        {{ clean_message | safe }}\r\n                    </div>\r\n                {% endfor %}\r\n            {% else %}\r\n                <div style=\"text-align: center; padding: 40px 20px;\">\r\n                    <p style=\"font-size: 16px; color: #cccccc; margin: 0;\">\r\n                        <strong>No summary generated yet.</strong>\r\n                    </p>\r\n                    <p style=\"font-size: 14px; color: #888888; margin-top: 10px;\">\r\n                        The AI-generated comparison summary will appear here once available.\r\n                    </p>\r\n                </div>\r\n            {% endif %}\r\n        </div>\r\n    </div>\r\n\r\n    <!-- Metrics Comparison Section -->\r\n    <div style=\"background: #1a1a1a; border-radius: 8px; padding: 20px; border: 1px solid #333;\">\r\n        <h2 style=\"color: #4a9eff; font-size: 18px; margin-bottom: 15px; font-weight: bold;\">Metrics Comparison{% if merged_data | length > 3 %} <span style=\"font-size: 12px; color: #cccccc; font-weight: normal;\">(Scroll to view all models)</span>{% endif %}</h2>\r\n        {% set num_models = merged_data | length %}\r\n        {% set table_height = 400 if num_models > 3 else 600 %}\r\n        {% set table_min_width = 1000 + (num_models - 3) * 200 if num_models > 3 else 1000 %}\r\n        <div style=\"overflow-x: auto; width: 100%; border: 1px solid #444; border-radius: 8px; max-height: {{ table_height }}px; overflow-y: auto;\">\r\n            <table style=\"width: 100%; min-width: {{ table_min_width }}px; border-collapse: collapse; background: #2a2a2a; border-radius: 8px;\">\r\n                <thead>\r\n                    <tr style=\"background: #333;\">\r\n                        <th style=\"padding: 12px 8px; text-align: left; border-bottom: 1px solid #444; color: #4a9eff; font-weight: bold; min-width: 160px; font-size: 13px; position: sticky; left: 0; background: #333; z-index: 10;\">Metric</th>\r\n                        {% for data in merged_data %}\r\n                        <th style=\"padding: 12px 8px; text-align: center; border-bottom: 1px solid #444; color: #4a9eff; font-weight: bold; min-width: 150px; white-space: nowrap; font-size: 12px; background: #333;\">\r\n                            {{ data.llm }}\r\n                        </th>\r\n                        {% endfor %}\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n\r\n                    <tr>\r\n                        <td style=\"padding: 10px 8px; border-bottom: 1px solid #444; color: #ffffff; font-weight: bold; background: #2a2a2a; font-size: 12px; position: sticky; left: 0; z-index: 5;\" title=\"Number of tokens used from the input prompt\">Input Tokens</td>\r\n                        {% for data in merged_data %}\r\n                        <td style=\"padding: 10px 8px; text-align: center; border-bottom: 1px solid #444; color: #ffffff; background: #2a2a2a; font-size: 11px;\">{{ \"{:,}\".format(data.token_usage_input_tokens) }}</td>\r\n                        {% endfor %}\r\n                    </tr>\r\n                    <tr>\r\n                        <td style=\"padding: 10px 8px; border-bottom: 1px solid #444; color: #ffffff; font-weight: bold; background: #2a2a2a; font-size: 12px; position: sticky; left: 0; z-index: 5;\" title=\"Time taken to generate the response (in seconds)\">Latency</td>\r\n                        {% for data in merged_data %}\r\n                        <td style=\"padding: 10px 8px; text-align: center; border-bottom: 1px solid #444; color: #ffffff; background: #2a2a2a; font-size: 11px;\">{{ \"%.2f\" | format(data.latency) }}s</td>\r\n                        {% endfor %}\r\n                    </tr>\r\n                    <tr>\r\n                        <td style=\"padding: 10px 8px; border-bottom: 1px solid #444; color: #ffffff; font-weight: bold; background: #2a2a2a; font-size: 12px; position: sticky; left: 0; z-index: 5;\" title=\"Number of tokens generated in the response\">Output Tokens</td>\r\n                        {% for data in merged_data %}\r\n                        <td style=\"padding: 10px 8px; text-align: center; border-bottom: 1px solid #444; color: #ffffff; background: #2a2a2a; font-size: 11px;\">{{ \"{:,}\".format(data.token_usage_output_tokens) }}</td>\r\n                        {% endfor %}\r\n                    </tr>\r\n                    <tr>\r\n                        <td style=\"padding: 10px 8px; border-bottom: 1px solid #444; color: #ffffff; font-weight: bold; background: #2a2a2a; font-size: 12px; position: sticky; left: 0; z-index: 5;\" title=\"Total tokens used (input + output)\">Total Tokens</td>\r\n                        {% for data in merged_data %}\r\n                        <td style=\"padding: 10px 8px; text-align: center; border-bottom: 1px solid #444; color: #ffffff; background: #2a2a2a; font-size: 11px;\">{{ \"{:,}\".format(data.token_usage_total_tokens) }}</td>\r\n                        {% endfor %}\r\n                    </tr>\r\n                    <tr>\r\n                        <td style=\"padding: 10px 8px; border-bottom: 1px solid #444; color: #ffffff; font-weight: bold; background: #2a2a2a; font-size: 12px; position: sticky; left: 0; z-index: 5;\">Pricing</td>\r\n                        {% for data in merged_data %}\r\n                        <td style=\"padding: 10px 8px; text-align: center; border-bottom: 1px solid #444; color: #ffffff; background: #2a2a2a; font-size: 10px;\">${{ costs[data.llm][0] if data.llm in costs else 0 }} per 1M input;<br>${{ costs[data.llm][1] if data.llm in costs else 0 }} per 1M output</td>\r\n                        {% endfor %}\r\n                    </tr>\r\n                    <tr>\r\n                        <td style=\"padding: 10px 8px; border-bottom: 1px solid #444; color: #ffffff; font-weight: bold; background: #2a2a2a; font-size: 12px; position: sticky; left: 0; z-index: 5;\" title=\"Cost for input tokens only\">Input Cost</td>\r\n                        {% for data in merged_data %}\r\n                        <td style=\"padding: 10px 8px; text-align: center; border-bottom: 1px solid #444; color: #ffffff; background: #2a2a2a; font-size: 11px;\">${{ \"%.4f\" | format(data.input_cost) }}</td>\r\n                        {% endfor %}\r\n                    </tr>\r\n                    <tr>\r\n                        <td style=\"padding: 10px 8px; border-bottom: 1px solid #444; color: #ffffff; font-weight: bold; background: #2a2a2a; font-size: 12px; position: sticky; left: 0; z-index: 5;\" title=\"Cost for output tokens only\">Output Cost</td>\r\n                        {% for data in merged_data %}\r\n                        <td style=\"padding: 10px 8px; text-align: center; border-bottom: 1px solid #444; color: #ffffff; background: #2a2a2a; font-size: 11px;\">${{ \"%.4f\" | format(data.output_cost) }}</td>\r\n                        {% endfor %}\r\n                    </tr>\r\n                    <tr>\r\n                        <td style=\"padding: 10px 8px; border-bottom: 1px solid #444; color: #ffffff; font-weight: bold; background: #2a2a2a; font-size: 12px; position: sticky; left: 0; z-index: 5;\" title=\"Total cost for this model's response (input + output tokens)\">Total Cost</td>\r\n                        {% for data in merged_data %}\r\n                        <td style=\"padding: 10px 8px; text-align: center; border-bottom: 1px solid #444; color: #ffffff; background: #2a2a2a; font-size: 11px;\">${{ \"%.4f\" | format(data.total_cost) }}</td>\r\n                        {% endfor %}\r\n                    </tr>\r\n                    <tr>\r\n                        <td style=\"padding: 10px 8px; border-bottom: 1px solid #444; color: #ffffff; font-weight: bold; background: #2a2a2a; font-size: 12px; position: sticky; left: 0; z-index: 5;\" title=\"Number of tools called during the response generation\">Tools Called</td>\r\n                        {% for data in merged_data %}\r\n                        <td style=\"padding: 10px 8px; text-align: center; border-bottom: 1px solid #444; color: #ffffff; background: #2a2a2a; font-size: 11px;\">{{ data.tool_count }}</td>\r\n                        {% endfor %}\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n\r\n<style>\r\n/* Simple scrollbar styling */\r\n::-webkit-scrollbar {\r\n    height: 8px;\r\n    width: 8px;\r\n}\r\n\r\n::-webkit-scrollbar-track {\r\n    background: #1a1a1a;\r\n    border-radius: 4px;\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n    background: #444;\r\n    border-radius: 4px;\r\n}\r\n\r\n::-webkit-scrollbar-thumb:hover {\r\n    background: #666;\r\n}\r\n\r\n/* Center the container */\r\nbody {\r\n    background: #000000;\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\n\r\n\r\na[href*=\"File%20Browser\"]:active {\r\n    transform: translateY(0);\r\n    box-shadow: 0 2px 4px rgba(0,0,0,0.2);\r\n}\r\n\r\n/* Custom scrollbar for summary container */\r\n.summary-scroll-container::-webkit-scrollbar {\r\n    width: 8px;\r\n}\r\n\r\n.summary-scroll-container::-webkit-scrollbar-track {\r\n    background: #1a1a1a;\r\n    border-radius: 4px;\r\n}\r\n\r\n.summary-scroll-container::-webkit-scrollbar-thumb {\r\n    background: #4a9eff;\r\n    border-radius: 4px;\r\n    box-shadow: 0 0 5px rgba(74, 158, 255, 0.3);\r\n}\r\n\r\n.summary-scroll-container::-webkit-scrollbar-thumb:hover {\r\n    background: #3a8eef;\r\n    box-shadow: 0 0 8px rgba(74, 158, 255, 0.5);\r\n}\r\n\r\n/* Custom scrollbar for individual model analysis */\r\n.individual-analysis-scroll::-webkit-scrollbar {\r\n    width: 6px;\r\n}\r\n\r\n.individual-analysis-scroll::-webkit-scrollbar-track {\r\n    background: #2a2a2a;\r\n    border-radius: 3px;\r\n}\r\n\r\n.individual-analysis-scroll::-webkit-scrollbar-thumb {\r\n    background: #555;\r\n    border-radius: 3px;\r\n}\r\n \r\n.individual-analysis-scroll::-webkit-scrollbar-thumb:hover {\r\n    background: #777;\r\n}\r\n</style>"
        }
    ],
    "storyboards": [
        {
            "name": "Metrics Comparison",
            "value": "{\r\n    \"stage\": {\r\n        \"size\": {\r\n            \"width\": 1500,\r\n            \"height\": 1300\r\n        },\r\n        \"background\": {\r\n            \"fill\": \"#161B21\",\r\n            \"src\": null,\r\n            \"gradient\": null\r\n        },\r\n        \"theme\": null,\r\n        \"autoFitByDefault\": true,\r\n        \"autoFitMinWidth\": 480\r\n    },\r\n    \"widgets\": [\r\n        {\r\n            \"widget_id\": \"31bcbd5c\",\r\n            \"layoutConfig\": {\r\n                \"rotation\": 0,\r\n                \"width\": 1490.7,\r\n                \"height\": 1287.61,\r\n                \"scaleX\": 1,\r\n                \"scaleY\": 1,\r\n                \"fill\": \"#fafafa33\",\r\n                \"opacity\": 1,\r\n                \"name\": \"widget-10\",\r\n                \"draggable\": false,\r\n                \"x\": 3.2,\r\n                \"y\": 5.16,\r\n                \"id\": \"cfx-92683519-111f-4f88-c3d1-1e6b03642f93\",\r\n                \"skewX\": 0,\r\n                \"skewY\": 0\r\n            }\r\n        }\r\n    ],\r\n    \"shapes\": [],\r\n    \"lines\": [],\r\n    \"sbBookmarkList\": []\r\n}"
        }
    ]
}